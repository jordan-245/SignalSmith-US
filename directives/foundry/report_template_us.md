# Signal Foundry — US Daily Report Template

## Purpose
This template defines the structure and sections for the US market daily report
generated by `execution/foundry/foundry_report.py`.

## Report Sections

### 1. Header
- Date, market, universe size, generation timestamp
- Run ID if available

### 2. Regime Summary
- Current regime label (Risk-On, Risk-Off, Transitional) with emoji indicator
- Recent regime history (last 5 × 4-week periods)
- Based on 20-day return and volatility of SPY or cross-sectional market median

### 3. Top Rankings
- Top 20 tickers ranked by ensemble P(up)
- Columns: Rank, Ticker, Price, P(up 1D), P(up 5D), P(up 20D), Ensemble, Tail Risk (5th percentile)
- Tail risk = 5th percentile of historical daily returns (worst-case proxy)

### 4. Catalyst Map
- Per-ticker news/events from Supabase `docs_extracted` table
- Shows headline, source, date, sentiment (positive/negative/neutral)
- Placeholder note when no catalyst data is available
- Max 3 events per ticker to keep report concise

### 5. Trade Plans
- Portfolio: $5,000 default
- Risk per trade: 2% of portfolio ($100)
- Summary table: Ticker, Entry, Stop, Target, R:R, Shares, Position size, % of portfolio
- Detailed plans for top 5:
  - Conviction level (High/Medium/Low based on P(up))
  - Entry: current price (market at open)
  - Stop (invalidation): 2x ATR below entry
  - Target: 3x risk distance above entry (3:1 R:R)
  - Position size: shares = risk_amount / stop_distance
  - ATR(14) value
  - Downside tail risk

### 6. Calibration Summary
- Evaluation window (last 120 trading days held out)
- Per-horizon metrics: AUC, Brier Score, Hit Rate, ECE
- Ensemble model (LogReg + RandomForest averaged)

### 7. Model Consensus
- Per-ticker breakdown showing individual model scores (5D horizon):
  - LogReg probability
  - RandomForest probability
  - Ensemble (average)
- Shows top 10 tickers from rankings

## Output Formats
- Markdown: `output/foundry/reports/US/YYYY-MM-DD.md`
- HTML: `output/foundry/reports/US/YYYY-MM-DD.html`
- Latest symlinks: `latest.md`, `latest.html`

## Telegram Summary
- Top 5 picks with probabilities and trade plans
- Generated by `execution/foundry/foundry_telegram.py`
- Uses HTML parse mode for Telegram formatting

## Data Sources
- Predictions: `data/foundry/predictions/market=US/run_id=*/part.parquet`
- Prices: `data/foundry/prices/market=US/run_id=*/part.parquet`
- Features: `data/foundry/features/market=US/feature_set=v1/date=*/part.parquet`
- Labels: `data/foundry/labels/market=US/date=*/part.parquet`
- Backtests: `data/foundry/backtests/market=US/run_id=*/part.parquet` (when available)
- Catalysts: Supabase `docs_extracted` table (optional)

## Configuration
- Universe: `directives/foundry/universe_us.txt` (S&P 500 constituents)
- Quality gates: `directives/foundry/quality_gates.yaml`
- Portfolio size and risk % configurable via CLI args
