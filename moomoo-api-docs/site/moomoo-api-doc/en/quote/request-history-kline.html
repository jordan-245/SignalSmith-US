<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Get Historical Candlesticks | moomoo API Doc v9.6</title>
    <meta name="generator" content="VuePress 1.5.3">
    
    <meta name="description" content="moomoo API Doc">
    <link rel="preload" href="/moomoo-api-doc/assets/css/0.styles.ea0b1d81.css" as="style"><link rel="preload" href="/moomoo-api-doc/assets/js/app.76d125c0.js" as="script"><link rel="preload" href="/moomoo-api-doc/assets/js/2.e1858e4a.js" as="script"><link rel="preload" href="/moomoo-api-doc/assets/js/75.654e7361.js" as="script"><link rel="preload" href="/moomoo-api-doc/assets/js/28.3fe3716c.js" as="script"><link rel="preload" href="/moomoo-api-doc/assets/js/35.424be492.js" as="script"><link rel="preload" href="/moomoo-api-doc/assets/js/24.9af08641.js" as="script"><link rel="prefetch" href="/moomoo-api-doc/assets/js/10.94bcbf16.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/100.5aad709f.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/101.6315f7fb.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/102.6cece76d.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/103.40195fc5.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/104.e0830381.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/105.936eb4d9.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/106.ed3aee2b.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/107.7748df13.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/108.39b67a60.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/109.4b1236e2.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/11.2fbf442f.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/110.bc264581.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/111.a9652fa1.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/112.038c2fcd.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/113.587f4a42.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/114.9203188f.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/115.0d36e730.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/116.0f4b866f.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/117.76221359.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/118.caa7bc9a.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/119.ba336510.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/12.c4851259.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/120.3683de14.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/121.ea95d7cb.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/122.618c3ed6.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/123.055b7010.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/124.c045cd63.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/125.d42b0714.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/126.b2f6e933.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/127.e9d110f8.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/128.a11f8202.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/129.6626eb94.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/13.4f3b3d7e.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/130.6539fcba.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/131.75bdf579.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/132.9d24d7e7.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/133.d9e1803b.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/134.a475efd5.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/135.cc33709b.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/136.21873923.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/137.69826660.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/138.31047450.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/139.ce995941.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/14.13b59c71.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/140.e70bdec0.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/141.d9d53a87.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/142.a04d0bea.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/143.a672978f.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/144.818a84ae.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/145.e46cc3df.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/146.a29ec4b9.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/147.5cfe641e.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/148.358ecaa0.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/149.3935be2f.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/15.3d02da17.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/150.40c46b61.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/151.3456807d.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/152.308a6ffd.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/153.d95721a5.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/154.c6b90cda.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/155.68c534de.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/156.fa6d7af3.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/157.a33831dd.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/158.56280019.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/159.9b880f55.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/16.33d80555.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/160.f4aa9622.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/161.727a3a78.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/162.941951ea.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/163.8b7da111.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/164.dfd53e0d.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/165.0c0855cd.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/166.21bd9238.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/167.e4ae9cf3.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/168.3f4281c0.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/169.f37d7335.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/17.6ac2d3ef.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/170.4376c120.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/171.948e10e3.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/18.7deab3c8.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/19.6e70cac3.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/20.c1df6286.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/21.5647999f.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/22.a50b564c.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/23.7870807e.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/25.f509878d.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/26.b1244706.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/27.082f3f2b.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/29.f69366ed.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/3.f9c39755.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/30.aee38619.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/31.7ab0c7db.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/32.d4a3260b.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/33.74565b1d.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/34.29135595.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/36.3857d105.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/37.7d889315.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/38.637a73c2.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/39.aa973d8f.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/4.04d2c45d.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/40.480f6bad.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/41.62d11f5f.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/42.6861ed24.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/43.b8eb0308.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/44.e0fc8394.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/45.12015c46.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/46.acc698c7.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/47.997f18b2.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/48.c0a3ed4b.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/49.605a98fa.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/5.8c452a45.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/50.ab8e902f.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/51.93a43c80.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/52.d7c28131.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/53.bc4fcbfa.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/54.f2134ef8.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/55.0fb8c79f.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/56.d6f1d66e.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/57.e3b3ea62.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/58.a3b791f0.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/59.15613da4.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/6.9a2ded1c.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/60.60f97ce5.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/61.adf5183d.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/62.10e9e40e.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/63.f3768483.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/64.5e7093fb.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/65.437af457.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/66.fc1b6993.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/67.14953f01.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/68.5b8d5ad6.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/69.7f2d1c8b.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/7.f1cb5afb.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/70.2cfa12e6.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/71.0acce1e8.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/72.74bec554.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/73.00d57d06.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/74.bbe2f552.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/76.e7abbb6c.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/77.9c2ecdf1.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/78.3eaa2d23.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/79.cc7f1ac2.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/8.e457aac2.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/80.148805ce.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/81.40dc2530.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/82.bbe1f83f.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/83.d1ecfd2c.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/84.5013f0ea.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/85.ed102602.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/86.f2975c25.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/87.7d6540bd.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/88.6f722f70.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/89.8fed8c82.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/9.c9d4402a.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/90.a15edebc.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/91.1f997c5d.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/92.dd51fa69.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/93.042545f6.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/94.71d9cc14.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/95.fb45f9d3.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/96.0f81a014.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/97.09768abd.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/98.cc14b450.js"><link rel="prefetch" href="/moomoo-api-doc/assets/js/99.6d2cbe79.js">
    <link rel="stylesheet" href="/moomoo-api-doc/assets/css/0.styles.ea0b1d81.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/moomoo-api-doc/en/" class="home-link router-link-active"><img src="/moomoo-api-doc/img/logo.png" alt="moomoo API Doc v9.6" class="logo"> <span class="site-name can-hide">moomoo API Doc v9.6</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="ftcode-links can-hide"><div class="ftcode-item"><div class="ftcode-dropdown-wrapper"><button type="button" aria-label="Programming Language" class="ftcode-dropdown-title"><span class="title">Programming Language</span> <span class="arrow right"></span></button> <ul class="ftcode-dropdown" style="display:none;"><li class="ftcode-dropdown-item"><!----> <span class="ftcode-link active"><span class="arrow active"></span> <span class="title active">Python</span></span></li><li class="ftcode-dropdown-item"><!----> <span class="ftcode-link"><span class="arrow"></span> <span class="title">C#</span></span></li><li class="ftcode-dropdown-item"><!----> <span class="ftcode-link"><span class="arrow"></span> <span class="title">Java</span></span></li><li class="ftcode-dropdown-item"><!----> <span class="ftcode-link"><span class="arrow"></span> <span class="title">C++</span></span></li><li class="ftcode-dropdown-item"><!----> <span class="ftcode-link"><span class="arrow"></span> <span class="title">JavaScript</span></span></li><li class="ftcode-dropdown-item"><!----> <span class="ftcode-link"><span class="arrow"></span> <span class="title">proto</span></span></li></ul></div></div></nav> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="简体中文" class="dropdown-title"><span class="title">简体中文</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/moomoo-api-doc/quote/request-history-kline.html" class="nav-link">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/moomoo-api-doc/en/quote/request-history-kline.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="ftcode-links"><div class="ftcode-item"><div class="ftcode-dropdown-wrapper"><button type="button" aria-label="Programming Language" class="ftcode-dropdown-title"><span class="title">Programming Language</span> <span class="arrow right"></span></button> <ul class="ftcode-dropdown" style="display:none;"><li class="ftcode-dropdown-item"><!----> <span class="ftcode-link active"><span class="arrow active"></span> <span class="title active">Python</span></span></li><li class="ftcode-dropdown-item"><!----> <span class="ftcode-link"><span class="arrow"></span> <span class="title">C#</span></span></li><li class="ftcode-dropdown-item"><!----> <span class="ftcode-link"><span class="arrow"></span> <span class="title">Java</span></span></li><li class="ftcode-dropdown-item"><!----> <span class="ftcode-link"><span class="arrow"></span> <span class="title">C++</span></span></li><li class="ftcode-dropdown-item"><!----> <span class="ftcode-link"><span class="arrow"></span> <span class="title">JavaScript</span></span></li><li class="ftcode-dropdown-item"><!----> <span class="ftcode-link"><span class="arrow"></span> <span class="title">proto</span></span></li></ul></div></div></nav> <nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="简体中文" class="dropdown-title"><span class="title">简体中文</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/moomoo-api-doc/quote/request-history-kline.html" class="nav-link">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="/moomoo-api-doc/en/quote/request-history-kline.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Introduction</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Quick Start</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>OpenD</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading openData"><span>Quote API</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/moomoo-api-doc/en/quote/overview.html" class="sidebar-link">Overview</a></li><li><a href="/moomoo-api-doc/en/quote/base.html" class="sidebar-link">Quote Object</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Real-Time Data</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading openData"><span>Basic Data</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/moomoo-api-doc/en/quote/get-market-state.html" class="sidebar-link">Get Market Status of Securities</a></li><li><a href="/moomoo-api-doc/en/quote/get-capital-flow.html" class="sidebar-link">Get Capital Flow</a></li><li><a href="/moomoo-api-doc/en/quote/get-capital-distribution.html" class="sidebar-link">Get Capital Distribution</a></li><li><a href="/moomoo-api-doc/en/quote/get-owner-plate.html" class="sidebar-link">Get Plates of Stocks</a></li><li><a href="/moomoo-api-doc/en/quote/request-history-kline.html" aria-current="page" class="active sidebar-link">Get Historical Candlesticks</a></li><li><a href="/moomoo-api-doc/en/quote/get-rehab.html" class="sidebar-link">Get Adjustment Factor</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Related Derivatives</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Market Filter</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Customization</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/moomoo-api-doc/en/quote/quote.html" class="sidebar-link">Quotation Definitions</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Trade API</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Basic API</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Q&amp;A</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="6265"><a href="#6265" class="header-anchor">#</a> Get Historical Candlesticks</h1> <div class="ft-doc-switcher"><div class="tab-content" style="display:none;"><div class="ft-switcher"><div class="tab-header" style="display:none;"><ul><li class="active"> Python
            </li><li> Proto
            </li><li> C#
            </li><li> Java
            </li><li> C++
            </li><li> JavaScript
            </li></ul></div> <div class="tab-content" style="display:;"><p><code>request_history_kline(code, start=None, end=None, ktype=KLType.K_DAY, autype=AuType.QFQ, fields=[KL_FIELD.ALL], max_count=1000, page_req_key=None, extended_time=False)</code></p> <ul><li><p><strong>Description</strong></p> <p>Get historical candlesticks</p></li> <li><p><strong>Parameters</strong></p> <table><thead><tr><th style="text-align:left;">Parameter</th> <th style="text-align:left;">Type</th> <th style="text-align:left;">Description</th></tr></thead> <tbody><tr><td style="text-align:left;">code</td> <td style="text-align:left;">str</td> <td style="text-align:left;">Stock code.</td></tr> <tr><td style="text-align:left;">start</td> <td style="text-align:left;">str</td> <td style="text-align:left;">Start time. <div class="fttip-wrapper"><button type="button" class="fttip-title"><span> </span> <img src="/moomoo-api-doc/img/tip.png" class="tip"></button> <div class="fttip-dropdown" style="display:none;"><div class="fttip-layout"><span class="fttip-uparrow"></span> <span class="fttip-uparrow2"></span> <div class="fttip-content">Format: yyyy-MM-dd<br>For example: &quot;2017-06-20&quot;.</div></div></div></div></td></tr> <tr><td style="text-align:left;">end</td> <td style="text-align:left;">str</td> <td style="text-align:left;">End time. <div class="fttip-wrapper"><button type="button" class="fttip-title"><span> </span> <img src="/moomoo-api-doc/img/tip.png" class="tip"></button> <div class="fttip-dropdown" style="display:none;"><div class="fttip-layout"><span class="fttip-uparrow"></span> <span class="fttip-uparrow2"></span> <div class="fttip-content">Format: yyyy-MM-dd<br>For example: &quot;2017-07-20&quot;.</div></div></div></div></td></tr> <tr><td style="text-align:left;">ktype</td> <td style="text-align:left;"><a href="/moomoo-api-doc/en/quote/quote.html#66">KLType</a></td> <td style="text-align:left;">Candlestick type.</td></tr> <tr><td style="text-align:left;">autype</td> <td style="text-align:left;"><a href="/moomoo-api-doc/en/quote/quote.html#7071">AuType</a></td> <td style="text-align:left;">Type of adjustment.</td></tr> <tr><td style="text-align:left;">fields</td> <td style="text-align:left;"><a href="/moomoo-api-doc/en/quote/quote.html#5803">KL_FIELD</a></td> <td style="text-align:left;">List of fields to be returned.</td></tr> <tr><td style="text-align:left;">max_count</td> <td style="text-align:left;">int</td> <td style="text-align:left;">The maximum number of candlesticks returned in this request. <div class="fttip-wrapper"><button type="button" class="fttip-title"><span> </span> <img src="/moomoo-api-doc/img/tip.png" class="tip"></button> <div class="fttip-dropdown" style="display:none;"><div class="fttip-layout"><span class="fttip-uparrow"></span> <span class="fttip-uparrow2"></span> <div class="fttip-content"><ul><li>Sending None indicates that all data between start and end is returned. </li><li>Note: OpenD requests all the data and then sends it to the script. If the number of candlesticks you want to obtain is more than 1000, it is recommended to select paging to prevent from timeout.</li></ul></div></div></div></div></td></tr> <tr><td style="text-align:left;">page_req_key</td> <td style="text-align:left;">bytes</td> <td style="text-align:left;">The key of the page request. If the number of candlesticks between start and end is more than max_count, then None should be passed at the first time you call this interface, and the page_req_key returned by the last call must be passed in the subsequent pagerequests.</td></tr> <tr><td style="text-align:left;">extended_time</td> <td style="text-align:left;">bool</td> <td style="text-align:left;">Need pre-market and after-hours data for US stocks or not. False: not need, True: need.</td></tr> <tr><td style="text-align:left;">session</td> <td style="text-align:left;"><a href="/moomoo-api-doc/en/quote/quote.html#8688">Session</a></td> <td style="text-align:left;">Get US stocks historical k-line in session <div class="fttip-wrapper"><button type="button" class="fttip-title"><span> </span> <img src="/moomoo-api-doc/img/tip.png" class="tip"></button> <div class="fttip-dropdown" style="display:none;"><div class="fttip-layout"><span class="fttip-uparrow"></span> <span class="fttip-uparrow2"></span> <div class="fttip-content"><ul><li>Only used to get historical k-line for US stocks in session.</li></ul><ul><li>If you want to get 24H historical k-line data of US stocks, please use 'ALL'. The 'OVERNIGHT' is not allowed.</li></ul><ul><li>Minimum version requirements: 9.2.4207</li></ul></div></div></div></div></td></tr></tbody></table> <ul><li>The combination of <em><strong>start</strong></em> and <em><strong>end</strong></em> is as follows
<table><thead><tr><th style="text-align:left;">Start type</th> <th style="text-align:left;">End type</th> <th style="text-align:left;">Description</th></tr></thead> <tbody><tr><td style="text-align:left;">str</td> <td style="text-align:left;">str</td> <td style="text-align:left;"><em><strong>start</strong></em> and <em><strong>end</strong></em> are the specified dates respectively.</td></tr> <tr><td style="text-align:left;">None</td> <td style="text-align:left;">str</td> <td style="text-align:left;"><em><strong>start</strong></em> is 365 days before <em><strong>end</strong></em>.</td></tr> <tr><td style="text-align:left;">str</td> <td style="text-align:left;">None</td> <td style="text-align:left;"><em><strong>end</strong></em> is 365 days after <em><strong>start</strong></em>.</td></tr> <tr><td style="text-align:left;">None</td> <td style="text-align:left;">None</td> <td style="text-align:left;"><em><strong>end</strong></em> is the current date, <em><strong>start</strong></em> is 365 days before.</td></tr></tbody></table></li></ul></li></ul> <ul><li><p><strong>Return</strong></p> <table><tr><th>Field</th> <th>Type</th> <th>Description</th></tr> <tr><td>ret</td> <td><a href="../ftapi/common.html#8800"> RET_CODE</a></td> <td>Interface result.</td></tr> <tr><td rowspan="2">data</td> <td>pd.DataFrame</td> <td>If ret == RET_OK, historical candlestick data is returned.</td></tr> <tr><td>str</td> <td>If ret != RET_OK, error description is returned.</td></tr> <tr><td>page_req_key</td> <td>bytes</td> <td>The key of the next page request.</td></tr></table> <ul><li>Historical candlestick data format as follows:
<table><thead><tr><th style="text-align:left;">Field</th> <th style="text-align:left;">Type</th> <th style="text-align:left;">Description</th></tr></thead> <tbody><tr><td style="text-align:left;">code</td> <td style="text-align:left;">str</td> <td style="text-align:left;">Stock code.</td></tr> <tr><td style="text-align:left;">name</td> <td style="text-align:left;">str</td> <td style="text-align:left;">Stock name.</td></tr> <tr><td style="text-align:left;">time_key</td> <td style="text-align:left;">str</td> <td style="text-align:left;">Candlestick time. <div class="fttip-wrapper"><button type="button" class="fttip-title"><span> </span> <img src="/moomoo-api-doc/img/tip.png" class="tip"></button> <div class="fttip-dropdown" style="display:none;"><div class="fttip-layout"><span class="fttip-uparrow"></span> <span class="fttip-uparrow2"></span> <div class="fttip-content">Format: yyyy-MM-dd HH:mm:ss<br>The default of HK stock market and A-share market is Beijing time, while that of US stock market is US Eastern time.</div></div></div></div></td></tr> <tr><td style="text-align:left;">open</td> <td style="text-align:left;">float</td> <td style="text-align:left;">Open.</td></tr> <tr><td style="text-align:left;">close</td> <td style="text-align:left;">float</td> <td style="text-align:left;">Close.</td></tr> <tr><td style="text-align:left;">high</td> <td style="text-align:left;">float</td> <td style="text-align:left;">High.</td></tr> <tr><td style="text-align:left;">low</td> <td style="text-align:left;">float</td> <td style="text-align:left;">Low.</td></tr> <tr><td style="text-align:left;">pe_ratio</td> <td style="text-align:left;">float</td> <td style="text-align:left;">P/E ratio. <div class="fttip-wrapper"><button type="button" class="fttip-title"><span> </span> <img src="/moomoo-api-doc/img/tip.png" class="tip"></button> <div class="fttip-dropdown" style="display:none;"><div class="fttip-layout"><span class="fttip-uparrow"></span> <span class="fttip-uparrow2"></span> <div class="fttip-content">This field is a ratio field, and % is not displayed.</div></div></div></div></td></tr> <tr><td style="text-align:left;">turnover_rate</td> <td style="text-align:left;">float</td> <td style="text-align:left;">Turnover rate.</td></tr> <tr><td style="text-align:left;">volume</td> <td style="text-align:left;">int</td> <td style="text-align:left;">Volume.</td></tr> <tr><td style="text-align:left;">turnover</td> <td style="text-align:left;">float</td> <td style="text-align:left;">Turnover.</td></tr> <tr><td style="text-align:left;">change_rate</td> <td style="text-align:left;">float</td> <td style="text-align:left;">Change rate.</td></tr> <tr><td style="text-align:left;">last_close</td> <td style="text-align:left;">float</td> <td style="text-align:left;">Yesterday's close.</td></tr></tbody></table></li></ul></li> <li><p><strong>Example</strong></p></li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> futu <span class="token keyword">import</span> <span class="token operator">*</span>
quote_ctx <span class="token operator">=</span> OpenQuoteContext<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">11111</span><span class="token punctuation">)</span>
ret<span class="token punctuation">,</span> data<span class="token punctuation">,</span> page_req_key <span class="token operator">=</span> quote_ctx<span class="token punctuation">.</span>request_history_kline<span class="token punctuation">(</span><span class="token string">'US.AAPL'</span><span class="token punctuation">,</span> start<span class="token operator">=</span><span class="token string">'2019-09-11'</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">'2019-09-18'</span><span class="token punctuation">,</span> max_count<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment"># 5 per page, request the first page</span>
<span class="token keyword">if</span> ret <span class="token operator">==</span> RET_OK<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># Take the first stock code</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'close'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># The closing price of the first page is converted to a list</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'error:'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
<span class="token keyword">while</span> page_req_key <span class="token operator">!=</span> <span class="token boolean">None</span><span class="token punctuation">:</span> <span class="token comment"># Request all results after</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'*************************************'</span><span class="token punctuation">)</span>
    ret<span class="token punctuation">,</span> data<span class="token punctuation">,</span> page_req_key <span class="token operator">=</span> quote_ctx<span class="token punctuation">.</span>request_history_kline<span class="token punctuation">(</span><span class="token string">'US.AAPL'</span><span class="token punctuation">,</span> start<span class="token operator">=</span><span class="token string">'2019-09-11'</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">'2019-09-18'</span><span class="token punctuation">,</span> max_count<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>page_req_key<span class="token operator">=</span>page_req_key<span class="token punctuation">)</span> <span class="token comment"># Request the page after turning data</span>
    <span class="token keyword">if</span> ret <span class="token operator">==</span> RET_OK<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'error:'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'All pages are finished!'</span><span class="token punctuation">)</span>
quote_ctx<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># After using the connection, remember to close it to prevent the number of connections from running out</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><ul><li><strong>Output</strong></li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code>code  name             time_key       <span class="token builtin">open</span>      close       high        low  pe_ratio  turnover_rate    volume      turnover  change_rate  last_close
<span class="token number">0</span>  US<span class="token punctuation">.</span>AAPL   APPLE  <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">11</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span>  <span class="token number">52.631194</span>  <span class="token number">53.963447</span>  <span class="token number">53.992409</span>  <span class="token number">52.549135</span>    <span class="token number">18.773</span>        <span class="token number">0.01039</span>  <span class="token number">177158584</span>  <span class="token number">9.808562e+09</span>     <span class="token number">3.179511</span>   <span class="token number">52.300545</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span>       <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>       <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>       <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>          <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token number">4</span>  US<span class="token punctuation">.</span>AAPL   APPLE  <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span>  <span class="token number">53.087346</span>  <span class="token number">53.265945</span>  <span class="token number">53.294907</span>  <span class="token number">52.884612</span>    <span class="token number">18.530</span>        <span class="token number">0.00432</span>   <span class="token number">73545872</span>  <span class="token number">4.046314e+09</span>     <span class="token number">0.363802</span>   <span class="token number">53.072865</span>

<span class="token punctuation">[</span><span class="token number">5</span> rows x <span class="token number">13</span> columns<span class="token punctuation">]</span>
US<span class="token punctuation">.</span>AAPL
<span class="token punctuation">[</span><span class="token number">53.9634465</span><span class="token punctuation">,</span> <span class="token number">53.84156475</span><span class="token punctuation">,</span> <span class="token number">52.7953125</span><span class="token punctuation">,</span> <span class="token number">53.072865</span><span class="token punctuation">,</span> <span class="token number">53.265945</span><span class="token punctuation">]</span>
<span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">*</span>
       code  name             time_key       <span class="token builtin">open</span>      close       high        low  pe_ratio  turnover_rate   volume      turnover  change_rate  last_close
<span class="token number">0</span>  US<span class="token punctuation">.</span>AAPL   APPLE  <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span>  <span class="token number">53.352831</span>  <span class="token number">53.76554</span>  <span class="token number">53.784847</span>  <span class="token number">52.961844</span>    <span class="token number">18.704</span>        <span class="token number">0.00602</span>  <span class="token number">102572372</span>  <span class="token number">5.682068e+09</span>     <span class="token number">0.937925</span>   <span class="token number">53.265945</span>
All pages are finished!
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></div><div class="tab-content" style="display:none;"><h2 id="4609"><a href="#4609" class="header-anchor">#</a> Qot_RequestHistoryKL.proto</h2> <ul><li><p><strong>Description</strong></p> <p>Get historical candlestics</p></li> <li><p><strong>Parameters</strong></p></li></ul> <div class="language-protobuf line-numbers-mode"><pre class="language-protobuf"><code>
<span class="token keyword">message</span> <span class="token class-name">C2S</span>
<span class="token punctuation">{</span>
    <span class="token keyword">required</span> <span class="token builtin">int32</span> rehabType <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//Qot_Common.RehabType, rehabilitation type</span>
    <span class="token keyword">required</span> <span class="token builtin">int32</span> klType <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">//Qot_Common.KLType, timeframe of candlestick</span>
    <span class="token keyword">required</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>Security</span> security <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">//Security code</span>
    <span class="token keyword">required</span> <span class="token builtin">string</span> beginTime <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">//Start time string (Format: yyyy-MM-dd)</span>
    <span class="token keyword">required</span> <span class="token builtin">string</span> endTime <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">//End time string (Format: yyyy-MM-dd)</span>
    <span class="token keyword">optional</span> <span class="token builtin">int32</span> maxAckKLNum <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span> <span class="token comment">//How many candlesticks can be returned at most, if not specified, it means no limit</span>
    <span class="token keyword">optional</span> <span class="token builtin">int64</span> needKLFieldsFlag <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span> <span class="token comment">//Specific fields of candlestick structure to return. A combination of KLFields enumeratio. If not specified, return all fields</span>
    <span class="token keyword">optional</span> <span class="token builtin">bytes</span> nextReqKey <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token comment">//Paging request key</span>
    <span class="token keyword">optional</span> <span class="token builtin">bool</span> extendedTime <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span> <span class="token comment">//Whether to get the pre-market and after-hours currently only supports timeframes of 60-minutes and below.</span>
    <span class="token keyword">optional</span> <span class="token builtin">int32</span> session <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">//Get non-regular data of US stocks, currently only supports timeframes of 60-minutes and below.</span>
<span class="token punctuation">}</span>

<span class="token keyword">message</span> <span class="token class-name">Request</span>
<span class="token punctuation">{</span>
	<span class="token keyword">required</span> <span class="token positional-class-name class-name">C2S</span> c2s <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><blockquote><ul><li>For stock structure refer to <a href="/moomoo-api-doc/en/quote/quote.html#5792">Security</a></li> <li>For stock adjustment type, refer to <a href="/moomoo-api-doc/en/quote/quote.html#7071">RehabType</a></li> <li>For candlestick type, refer to <a href="/moomoo-api-doc/en/quote/quote.html#66">KLType</a></li> <li>For candlestick structure, refer to <a href="/moomoo-api-doc/en/quote/quote.html#5803">KLFields</a></li></ul></blockquote> <ul><li><strong>Return</strong></li></ul> <div class="language-protobuf line-numbers-mode"><pre class="language-protobuf"><code>
<span class="token keyword">message</span> <span class="token class-name">S2C</span>
<span class="token punctuation">{</span>
    <span class="token keyword">required</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>Security</span> security <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//Security</span>
    <span class="token keyword">optional</span> <span class="token builtin">string</span> name <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">// Stock name</span>
    <span class="token keyword">repeated</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>KLine</span> klList <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">//Candlestick data</span>
    <span class="token keyword">optional</span> <span class="token builtin">bytes</span> nextReqKey <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">//Paging request key.</span>
<span class="token punctuation">}</span>

<span class="token keyword">message</span> <span class="token class-name">Response</span>
<span class="token punctuation">{</span>
	<span class="token keyword">required</span> <span class="token builtin">int32</span> retType <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">[</span><span class="token annotation">default</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">400</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//RetType, returned value</span>
	<span class="token keyword">optional</span> <span class="token builtin">string</span> retMsg <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">optional</span> <span class="token builtin">int32</span> errCode <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
	
	<span class="token keyword">optional</span> <span class="token positional-class-name class-name">S2C</span> s2c <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><blockquote><ul><li>For stock structure refer to <a href="/moomoo-api-doc/en/quote/quote.html#5792">Security</a></li> <li>For candlestick structure, refer to <a href="/moomoo-api-doc/en/quote/quote.html#500">KLine</a></li> <li>For interface result, refer to <a href="/moomoo-api-doc/en/ftapi/common.html#8800">RetType</a></li></ul></blockquote> <ul><li><p><strong>Protocol ID</strong></p> <p>3103</p></li></ul></div><div class="tab-content" style="display:none;"><p><code>uint RequestHistoryKL(QotRequestHistoryKL.Request req);</code><br> <code>virtual void OnReply_RequestHistoryKL(FTAPI_Conn client, uint nSerialNo, QotRequestHistoryKL.Response rsp);</code></p> <ul><li><p><strong>Description</strong></p> <p>Get historical candlesticks</p></li> <li><p><strong>Parameters</strong></p></li></ul> <div class="language-protobuf line-numbers-mode"><pre class="language-protobuf"><code>
<span class="token keyword">message</span> <span class="token class-name">C2S</span>
<span class="token punctuation">{</span>
    <span class="token keyword">required</span> <span class="token builtin">int32</span> rehabType <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//Qot_Common.RehabType, rehabilitation type</span>
    <span class="token keyword">required</span> <span class="token builtin">int32</span> klType <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">//Qot_Common.KLType, timeframe of candlestick</span>
    <span class="token keyword">required</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>Security</span> security <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">//Security code</span>
    <span class="token keyword">required</span> <span class="token builtin">string</span> beginTime <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">//Start time string (Format: yyyy-MM-dd)</span>
    <span class="token keyword">required</span> <span class="token builtin">string</span> endTime <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">//End time string (Format: yyyy-MM-dd)</span>
    <span class="token keyword">optional</span> <span class="token builtin">int32</span> maxAckKLNum <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span> <span class="token comment">//How many candlesticks can be returned at most, if not specified, it means no limit</span>
    <span class="token keyword">optional</span> <span class="token builtin">int64</span> needKLFieldsFlag <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span> <span class="token comment">//Specific fields of candlestick structure to return. A combination of KLFields enumeratio. If not specified, return all fields</span>
    <span class="token keyword">optional</span> <span class="token builtin">bytes</span> nextReqKey <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token comment">//Paging request key</span>
    <span class="token keyword">optional</span> <span class="token builtin">bool</span> extendedTime <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span> <span class="token comment">//Whether to get the pre-market and after-hours currently only supports timeframes of 60-minutes and below.</span>
    <span class="token keyword">optional</span> <span class="token builtin">int32</span> session <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">//Get non-regular data of US stocks, currently only supports timeframes of 60-minutes and below.</span>

<span class="token keyword">message</span> <span class="token class-name">Request</span>
<span class="token punctuation">{</span>
	<span class="token keyword">required</span> <span class="token positional-class-name class-name">C2S</span> c2s <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><blockquote><ul><li>For stock structure refer to <a href="/moomoo-api-doc/en/quote/quote.html#5792">Security</a></li> <li>For stock adjustment type, refer to <a href="/moomoo-api-doc/en/quote/quote.html#7071">RehabType</a></li> <li>For candlestick type, refer to <a href="/moomoo-api-doc/en/quote/quote.html#66">KLType</a></li> <li>For candlestick structure, refer to <a href="/moomoo-api-doc/en/quote/quote.html#5803">KLFields</a></li></ul></blockquote> <ul><li><strong>Return</strong></li></ul> <div class="language-protobuf line-numbers-mode"><pre class="language-protobuf"><code>
<span class="token keyword">message</span> <span class="token class-name">S2C</span>
<span class="token punctuation">{</span>
    <span class="token keyword">required</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>Security</span> security <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//Security</span>
    <span class="token keyword">optional</span> <span class="token builtin">string</span> name <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">// Stock name</span>
    <span class="token keyword">repeated</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>KLine</span> klList <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">//Candlestick data</span>
    <span class="token keyword">optional</span> <span class="token builtin">bytes</span> nextReqKey <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">//Paging request key.</span>
<span class="token punctuation">}</span>

<span class="token keyword">message</span> <span class="token class-name">Response</span>
<span class="token punctuation">{</span>
	<span class="token keyword">required</span> <span class="token builtin">int32</span> retType <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">[</span><span class="token annotation">default</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">400</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//RetType, returned value</span>
	<span class="token keyword">optional</span> <span class="token builtin">string</span> retMsg <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">optional</span> <span class="token builtin">int32</span> errCode <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
	
	<span class="token keyword">optional</span> <span class="token positional-class-name class-name">S2C</span> s2c <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><blockquote><ul><li>For stock structure refer to <a href="/moomoo-api-doc/en/quote/quote.html#5792">Security</a></li> <li>For candlestick structure, refer to <a href="/moomoo-api-doc/en/quote/quote.html#500">KLine</a></li> <li>For interface result, refer to <a href="/moomoo-api-doc/en/ftapi/common.html#8800">RetType</a></li></ul></blockquote> <ul><li><strong>Example</strong></li></ul> <div class="language-cs line-numbers-mode"><pre class="language-cs"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Program</span><span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">FTSPI_Qot</span><span class="token punctuation">,</span> <span class="token class-name">FTSPI_Conn</span></span> <span class="token punctuation">{</span>
    <span class="token class-name">FTAPI_Qot</span> qot <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FTAPI_Qot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">Program</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        qot<span class="token punctuation">.</span><span class="token function">SetClientInfo</span><span class="token punctuation">(</span><span class="token string">&quot;csharp&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Set client information</span>
        qot<span class="token punctuation">.</span><span class="token function">SetConnCallback</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Set connection callback</span>
        qot<span class="token punctuation">.</span><span class="token function">SetQotCallback</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Set transaction callback</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        qot<span class="token punctuation">.</span><span class="token function">InitConnect</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">ushort</span><span class="token punctuation">)</span><span class="token number">11111</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnInitConnect</span><span class="token punctuation">(</span><span class="token class-name">FTAPI_Conn</span> client<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">long</span></span> errCode<span class="token punctuation">,</span> <span class="token class-name">String</span> desc<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">&quot;Qot onInitConnect: ret={0} desc={1} connID={2}\n&quot;</span><span class="token punctuation">,</span> errCode<span class="token punctuation">,</span> desc<span class="token punctuation">,</span> client<span class="token punctuation">.</span><span class="token function">GetConnectID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>errCode <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>

        <span class="token class-name">QotCommon<span class="token punctuation">.</span>Security</span> sec <span class="token operator">=</span> QotCommon<span class="token punctuation">.</span>Security<span class="token punctuation">.</span><span class="token function">CreateBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">SetMarket</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>QotCommon<span class="token punctuation">.</span>QotMarket<span class="token punctuation">.</span>QotMarket_HK_Security<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">SetCode</span><span class="token punctuation">(</span><span class="token string">&quot;00700&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">QotRequestHistoryKL<span class="token punctuation">.</span>C2S</span> c2s <span class="token operator">=</span> QotRequestHistoryKL<span class="token punctuation">.</span>C2S<span class="token punctuation">.</span><span class="token function">CreateBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">SetRehabType</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>QotCommon<span class="token punctuation">.</span>RehabType<span class="token punctuation">.</span>RehabType_Forward<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">SetKlType</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>QotCommon<span class="token punctuation">.</span>KLType<span class="token punctuation">.</span>KLType_1Min<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">SetSecurity</span><span class="token punctuation">(</span>sec<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">SetBeginTime</span><span class="token punctuation">(</span><span class="token string">&quot;2020-09-01&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">SetEndTime</span><span class="token punctuation">(</span><span class="token string">&quot;2020-09-10&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">QotRequestHistoryKL<span class="token punctuation">.</span>Request</span> req <span class="token operator">=</span> QotRequestHistoryKL<span class="token punctuation">.</span>Request<span class="token punctuation">.</span><span class="token function">CreateBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetC2S</span><span class="token punctuation">(</span>c2s<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">uint</span></span> seqNo <span class="token operator">=</span> qot<span class="token punctuation">.</span><span class="token function">RequestHistoryKL</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">&quot;Send QotRequestHistoryKL: {0}\n&quot;</span><span class="token punctuation">,</span> seqNo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnDisconnect</span><span class="token punctuation">(</span><span class="token class-name">FTAPI_Conn</span> client<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">long</span></span> errCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">&quot;Qot onDisConnect: {0}\n&quot;</span><span class="token punctuation">,</span> errCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnReply_RequestHistoryKL</span><span class="token punctuation">(</span><span class="token class-name">FTAPI_Conn</span> client<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">uint</span></span> nSerialNo<span class="token punctuation">,</span> <span class="token class-name">QotRequestHistoryKL<span class="token punctuation">.</span>Response</span> rsp<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">&quot;Reply: QotRequestHistoryKL: {0}  {1}\n&quot;</span><span class="token punctuation">,</span> nSerialNo<span class="token punctuation">,</span> rsp<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">&quot;Code: {0},  lastClosePrice: {1} \n&quot;</span><span class="token punctuation">,</span>
            rsp<span class="token punctuation">.</span>S2C<span class="token punctuation">.</span>Security<span class="token punctuation">.</span>Code<span class="token punctuation">,</span>
            rsp<span class="token punctuation">.</span>S2C<span class="token punctuation">.</span>KlListList<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>LastClosePrice<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name">String<span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        FTAPI<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Program</span> qot <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Program</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        qot<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
            Thread<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br></div></div><ul><li><strong>Output</strong></li></ul> <div class="language-cs line-numbers-mode"><pre class="language-cs"><code><span class="token class-name">Qot</span> onInitConnect<span class="token punctuation">:</span> ret<span class="token operator">=</span><span class="token number">0</span> desc<span class="token operator">=</span> connID<span class="token operator">=</span><span class="token number">6819076272648767075</span>
<span class="token class-name">Send</span> QotRequestHistoryKL<span class="token punctuation">:</span> <span class="token number">3</span>
Reply<span class="token punctuation">:</span> QotRequestHistoryKL<span class="token punctuation">:</span> <span class="token number">3</span>  retType<span class="token punctuation">:</span> <span class="token number">0</span>
retMsg<span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span>
errCode<span class="token punctuation">:</span> <span class="token number">0</span>
s2c <span class="token punctuation">{</span>
  security <span class="token punctuation">{</span>
    market<span class="token punctuation">:</span> <span class="token number">1</span>
    code<span class="token punctuation">:</span> <span class="token string">&quot;00700&quot;</span>
  <span class="token punctuation">}</span>
  klList <span class="token punctuation">{</span>
    time<span class="token punctuation">:</span> <span class="token string">&quot;2020-09-01 09:30:00&quot;</span>
    isBlank<span class="token punctuation">:</span> <span class="token class-name">false</span>
    highPrice<span class="token punctuation">:</span> <span class="token number">535.9</span>
    openPrice<span class="token punctuation">:</span> <span class="token number">535.9</span>
    lowPrice<span class="token punctuation">:</span> <span class="token number">535.9</span>
    closePrice<span class="token punctuation">:</span> <span class="token number">535.9</span>
    lastClosePrice<span class="token punctuation">:</span> <span class="token number">528.9</span>
    volume<span class="token punctuation">:</span> <span class="token number">665000</span>
    turnover<span class="token punctuation">:</span> <span class="token number">357437500</span>
    turnoverRate<span class="token punctuation">:</span> <span class="token number">0</span>
    pe<span class="token punctuation">:</span> <span class="token number">0</span>
    changeRate<span class="token punctuation">:</span> <span class="token number">1.3235016071090944</span>
    timestamp<span class="token punctuation">:</span> <span class="token number">1598923800</span>
  <span class="token punctuation">}</span>
  <span class="token range operator">..</span><span class="token punctuation">.</span>
  klList <span class="token punctuation">{</span>
    time<span class="token punctuation">:</span> <span class="token string">&quot;2020-09-09 16:00:00&quot;</span>
    isBlank<span class="token punctuation">:</span> <span class="token class-name">false</span>
    highPrice<span class="token punctuation">:</span> <span class="token number">503.9</span>
    openPrice<span class="token punctuation">:</span> <span class="token number">502.4</span>
    lowPrice<span class="token punctuation">:</span> <span class="token number">501.9</span>
    closePrice<span class="token punctuation">:</span> <span class="token number">502.4</span>
    lastClosePrice<span class="token punctuation">:</span> <span class="token number">502.9</span>
    volume<span class="token punctuation">:</span> <span class="token number">1504800</span>
    turnover<span class="token punctuation">:</span> <span class="token number">758472600</span>
    turnoverRate<span class="token punctuation">:</span> <span class="token number">0</span>
    pe<span class="token punctuation">:</span> <span class="token number">0</span>
    changeRate<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">0.0994233446013124</span>
    timestamp<span class="token punctuation">:</span> <span class="token number">1599638400</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

Code<span class="token punctuation">:</span> <span class="token number">00700</span><span class="token punctuation">,</span>  <span class="token named-parameter punctuation">lastClosePrice</span><span class="token punctuation">:</span> <span class="token number">528.9</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div></div><div class="tab-content" style="display:none;"><p><code>int requestHistoryKL(QotRequestHistoryKL.Request req);</code><br> <code>void onReply_RequestHistoryKL(FTAPI_Conn client, int nSerialNo, QotRequestHistoryKL.Response rsp);</code></p> <ul><li><p><strong>Description</strong></p> <p>Get historical candlesticks</p></li> <li><p><strong>Parameters</strong></p></li></ul> <div class="language-protobuf line-numbers-mode"><pre class="language-protobuf"><code>
<span class="token keyword">message</span> <span class="token class-name">C2S</span>
<span class="token punctuation">{</span>
    <span class="token keyword">required</span> <span class="token builtin">int32</span> rehabType <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//Qot_Common.RehabType, rehabilitation type</span>
    <span class="token keyword">required</span> <span class="token builtin">int32</span> klType <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">//Qot_Common.KLType, timeframe of candlestick</span>
    <span class="token keyword">required</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>Security</span> security <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">//Security code</span>
    <span class="token keyword">required</span> <span class="token builtin">string</span> beginTime <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">//Start time string (Format: yyyy-MM-dd)</span>
    <span class="token keyword">required</span> <span class="token builtin">string</span> endTime <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">//End time string (Format: yyyy-MM-dd)</span>
    <span class="token keyword">optional</span> <span class="token builtin">int32</span> maxAckKLNum <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span> <span class="token comment">//How many candlesticks can be returned at most, if not specified, it means no limit</span>
    <span class="token keyword">optional</span> <span class="token builtin">int64</span> needKLFieldsFlag <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span> <span class="token comment">//Specific fields of candlestick structure to return. A combination of KLFields enumeratio. If not specified, return all fields</span>
    <span class="token keyword">optional</span> <span class="token builtin">bytes</span> nextReqKey <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token comment">//Paging request key</span>
    <span class="token keyword">optional</span> <span class="token builtin">bool</span> extendedTime <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span> <span class="token comment">//Whether to get the pre-market and after-hours currently only supports timeframes of 60-minutes and below.</span>
    <span class="token keyword">optional</span> <span class="token builtin">int32</span> session <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">//Get non-regular data of US stocks, currently only supports timeframes of 60-minutes and below.</span>
<span class="token punctuation">}</span>

<span class="token keyword">message</span> <span class="token class-name">Request</span>
<span class="token punctuation">{</span>
	<span class="token keyword">required</span> <span class="token positional-class-name class-name">C2S</span> c2s <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><blockquote><ul><li>For stock structure refer to <a href="/moomoo-api-doc/en/quote/quote.html#5792">Security</a></li> <li>For stock adjustment type, refer to <a href="/moomoo-api-doc/en/quote/quote.html#7071">RehabType</a></li> <li>For candlestick type, refer to <a href="/moomoo-api-doc/en/quote/quote.html#66">KLType</a></li> <li>For candlestick structure, refer to <a href="/moomoo-api-doc/en/quote/quote.html#5803">KLFields</a></li></ul></blockquote> <ul><li><strong>Return</strong></li></ul> <div class="language-protobuf line-numbers-mode"><pre class="language-protobuf"><code>
<span class="token keyword">message</span> <span class="token class-name">S2C</span>
<span class="token punctuation">{</span>
    <span class="token keyword">required</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>Security</span> security <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//Security</span>
    <span class="token keyword">optional</span> <span class="token builtin">string</span> name <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">// Stock name</span>
    <span class="token keyword">repeated</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>KLine</span> klList <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">//Candlestick data</span>
    <span class="token keyword">optional</span> <span class="token builtin">bytes</span> nextReqKey <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">//Paging request key.</span>
<span class="token punctuation">}</span>

<span class="token keyword">message</span> <span class="token class-name">Response</span>
<span class="token punctuation">{</span>
	<span class="token keyword">required</span> <span class="token builtin">int32</span> retType <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">[</span><span class="token annotation">default</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">400</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//RetType, returned value</span>
	<span class="token keyword">optional</span> <span class="token builtin">string</span> retMsg <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">optional</span> <span class="token builtin">int32</span> errCode <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
	
	<span class="token keyword">optional</span> <span class="token positional-class-name class-name">S2C</span> s2c <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><blockquote><ul><li>For stock structure refer to <a href="/moomoo-api-doc/en/quote/quote.html#5792">Security</a></li> <li>For candlestick structure, refer to <a href="/moomoo-api-doc/en/quote/quote.html#500">KLine</a></li> <li>For interface result, refer to <a href="/moomoo-api-doc/en/ftapi/common.html#8800">RetType</a></li></ul></blockquote> <ul><li><strong>Example</strong></li></ul> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QotDemo</span> <span class="token keyword">implements</span> <span class="token class-name">FTSPI_Qot</span><span class="token punctuation">,</span> <span class="token class-name">FTSPI_Conn</span> <span class="token punctuation">{</span>
    <span class="token class-name">FTAPI_Conn_Qot</span> qot <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FTAPI_Conn_Qot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">QotDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        qot<span class="token punctuation">.</span><span class="token function">setClientInfo</span><span class="token punctuation">(</span><span class="token string">&quot;javaclient&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Set client information</span>
        qot<span class="token punctuation">.</span><span class="token function">setConnSpi</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Set connection callback</span>
        qot<span class="token punctuation">.</span><span class="token function">setQotSpi</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Set transaction callback</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        qot<span class="token punctuation">.</span><span class="token function">initConnect</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">short</span><span class="token punctuation">)</span><span class="token number">11111</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onInitConnect</span><span class="token punctuation">(</span><span class="token class-name">FTAPI_Conn</span> client<span class="token punctuation">,</span> <span class="token keyword">long</span> errCode<span class="token punctuation">,</span> <span class="token class-name">String</span> desc<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Qot onInitConnect: ret=%b desc=%s connID=%d\n&quot;</span><span class="token punctuation">,</span> errCode<span class="token punctuation">,</span> desc<span class="token punctuation">,</span> client<span class="token punctuation">.</span><span class="token function">getConnectID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>errCode <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>

        <span class="token class-name">QotCommon<span class="token punctuation">.</span>Security</span> sec <span class="token operator">=</span> <span class="token class-name">QotCommon<span class="token punctuation">.</span>Security</span><span class="token punctuation">.</span><span class="token function">newBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setMarket</span><span class="token punctuation">(</span><span class="token class-name">QotCommon<span class="token punctuation">.</span>QotMarket<span class="token punctuation">.</span>QotMarket_HK_Security_VALUE</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setCode</span><span class="token punctuation">(</span><span class="token string">&quot;00700&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">QotRequestHistoryKL</span><span class="token punctuation">.</span><span class="token constant">C2S</span> c2s <span class="token operator">=</span> <span class="token class-name">QotRequestHistoryKL</span><span class="token punctuation">.</span><span class="token constant">C2S</span><span class="token punctuation">.</span><span class="token function">newBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setRehabType</span><span class="token punctuation">(</span><span class="token class-name">QotCommon<span class="token punctuation">.</span>RehabType<span class="token punctuation">.</span>RehabType_Forward_VALUE</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setKlType</span><span class="token punctuation">(</span><span class="token class-name">QotCommon<span class="token punctuation">.</span>KLType<span class="token punctuation">.</span>KLType_1Min_VALUE</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setSecurity</span><span class="token punctuation">(</span>sec<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setBeginTime</span><span class="token punctuation">(</span><span class="token string">&quot;2020-09-01&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setEndTime</span><span class="token punctuation">(</span><span class="token string">&quot;2020-09-02&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">QotRequestHistoryKL<span class="token punctuation">.</span>Request</span> req <span class="token operator">=</span> <span class="token class-name">QotRequestHistoryKL<span class="token punctuation">.</span>Request</span><span class="token punctuation">.</span><span class="token function">newBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setC2S</span><span class="token punctuation">(</span>c2s<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> seqNo <span class="token operator">=</span> qot<span class="token punctuation">.</span><span class="token function">requestHistoryKL</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Send QotRequestHistoryKL: %d\n&quot;</span><span class="token punctuation">,</span> seqNo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onDisconnect</span><span class="token punctuation">(</span><span class="token class-name">FTAPI_Conn</span> client<span class="token punctuation">,</span> <span class="token keyword">long</span> errCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Qot onDisConnect: %d\n&quot;</span><span class="token punctuation">,</span> errCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onReply_RequestHistoryKL</span><span class="token punctuation">(</span><span class="token class-name">FTAPI_Conn</span> client<span class="token punctuation">,</span> <span class="token keyword">int</span> nSerialNo<span class="token punctuation">,</span> <span class="token class-name">QotRequestHistoryKL<span class="token punctuation">.</span>Response</span> rsp<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>rsp<span class="token punctuation">.</span><span class="token function">getRetType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;QotRequestHistoryKL failed: %s\n&quot;</span><span class="token punctuation">,</span> rsp<span class="token punctuation">.</span><span class="token function">getRetMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token class-name">String</span> json <span class="token operator">=</span> <span class="token class-name">JsonFormat</span><span class="token punctuation">.</span><span class="token function">printer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>rsp<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Receive QotRequestHistoryKL: %s\n&quot;</span><span class="token punctuation">,</span> json<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InvalidProtocolBufferException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token constant">FTAPI</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">QotDemo</span> qot <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QotDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        qot<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> exc<span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br></div></div><ul><li><strong>Output</strong></li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>Send QotRequestHistoryKL: 2
Receive QotRequestHistoryKL: {
  &quot;retType&quot;: 0,
  &quot;retMsg&quot;: &quot;&quot;,
  &quot;errCode&quot;: 0,
  &quot;s2c&quot;: {
    &quot;security&quot;: {
      &quot;market&quot;: 1,
      &quot;code&quot;: &quot;00700&quot;
    },
    &quot;klList&quot;: [{
      &quot;time&quot;: &quot;2020-09-01 09:30:00&quot;,
      &quot;isBlank&quot;: false,
      &quot;highPrice&quot;: 535.9,
      &quot;openPrice&quot;: 535.9,
      &quot;lowPrice&quot;: 535.9,
      &quot;closePrice&quot;: 535.9,
      &quot;lastClosePrice&quot;: 528.9,
      &quot;volume&quot;: &quot;665000&quot;,
      &quot;turnover&quot;: 3.574375E8,
      &quot;turnoverRate&quot;: 0.0,
      &quot;pe&quot;: 0.0,
      &quot;changeRate&quot;: 1.3235016071090944,
      &quot;timestamp&quot;: 1.5989238E9
    }, ... {
      &quot;time&quot;: &quot;2020-09-01 16:00:00&quot;,
      &quot;isBlank&quot;: false,
      &quot;highPrice&quot;: 542.4,
      &quot;openPrice&quot;: 542.4,
      &quot;lowPrice&quot;: 537.4,
      &quot;closePrice&quot;: 537.4,
      &quot;lastClosePrice&quot;: 542.4,
      &quot;volume&quot;: &quot;1303900&quot;,
      &quot;turnover&quot;: 7.0309225E8,
      &quot;turnoverRate&quot;: 0.0,
      &quot;pe&quot;: 0.0,
      &quot;changeRate&quot;: -0.9218289085545722,
      &quot;timestamp&quot;: 1.5989472E9
    }]
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div></div><div class="tab-content" style="display:none;"><p><code>Futu::u32_t RequestHistoryKL(const Qot_RequestHistoryKL::Request &amp;stReq);</code><br> <code>virtual void OnReply_RequestHistoryKL(Futu::u32_t nSerialNo, const Qot_RequestHistoryKL::Response &amp;stRsp) = 0;</code></p> <ul><li><p><strong>Description</strong></p> <p>Get historical candlesticks</p></li> <li><p><strong>Parameters</strong></p></li></ul> <div class="language-protobuf line-numbers-mode"><pre class="language-protobuf"><code>
<span class="token keyword">message</span> <span class="token class-name">C2S</span>
<span class="token punctuation">{</span>
    <span class="token keyword">required</span> <span class="token builtin">int32</span> rehabType <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//Qot_Common.RehabType, rehabilitation type</span>
    <span class="token keyword">required</span> <span class="token builtin">int32</span> klType <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">//Qot_Common.KLType, timeframe of candlestick</span>
    <span class="token keyword">required</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>Security</span> security <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">//Security code</span>
    <span class="token keyword">required</span> <span class="token builtin">string</span> beginTime <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">//Start time string (Format: yyyy-MM-dd)</span>
    <span class="token keyword">required</span> <span class="token builtin">string</span> endTime <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">//End time string (Format: yyyy-MM-dd)</span>
    <span class="token keyword">optional</span> <span class="token builtin">int32</span> maxAckKLNum <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span> <span class="token comment">//How many candlesticks can be returned at most, if not specified, it means no limit</span>
    <span class="token keyword">optional</span> <span class="token builtin">int64</span> needKLFieldsFlag <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span> <span class="token comment">//Specific fields of candlestick structure to return. A combination of KLFields enumeratio. If not specified, return all fields</span>
    <span class="token keyword">optional</span> <span class="token builtin">bytes</span> nextReqKey <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token comment">//Paging request key</span>
    <span class="token keyword">optional</span> <span class="token builtin">bool</span> extendedTime <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span> <span class="token comment">//Whether to get the pre-market and after-hours currently only supports timeframes of 60-minutes and below.</span>
    <span class="token keyword">optional</span> <span class="token builtin">int32</span> session <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">//Get non-regular data of US stocks, currently only supports timeframes of 60-minutes and below.</span>
<span class="token punctuation">}</span>

<span class="token keyword">message</span> <span class="token class-name">Request</span>
<span class="token punctuation">{</span>
	<span class="token keyword">required</span> <span class="token positional-class-name class-name">C2S</span> c2s <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><blockquote><ul><li>For stock structure refer to <a href="/moomoo-api-doc/en/quote/quote.html#5792">Security</a></li> <li>For stock adjustment type, refer to <a href="/moomoo-api-doc/en/quote/quote.html#7071">RehabType</a></li> <li>For candlestick type, refer to <a href="/moomoo-api-doc/en/quote/quote.html#66">KLType</a></li> <li>For candlestick structure, refer to <a href="/moomoo-api-doc/en/quote/quote.html#5803">KLFields</a></li></ul></blockquote> <ul><li><strong>Return</strong></li></ul> <div class="language-protobuf line-numbers-mode"><pre class="language-protobuf"><code>
<span class="token keyword">message</span> <span class="token class-name">S2C</span>
<span class="token punctuation">{</span>
    <span class="token keyword">required</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>Security</span> security <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//Security</span>
    <span class="token keyword">optional</span> <span class="token builtin">string</span> name <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">// Stock name</span>
    <span class="token keyword">repeated</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>KLine</span> klList <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">//Candlestick data</span>
    <span class="token keyword">optional</span> <span class="token builtin">bytes</span> nextReqKey <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">//Paging request key.</span>
<span class="token punctuation">}</span>

<span class="token keyword">message</span> <span class="token class-name">Response</span>
<span class="token punctuation">{</span>
	<span class="token keyword">required</span> <span class="token builtin">int32</span> retType <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">[</span><span class="token annotation">default</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">400</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//RetType, returned value</span>
	<span class="token keyword">optional</span> <span class="token builtin">string</span> retMsg <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">optional</span> <span class="token builtin">int32</span> errCode <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
	
	<span class="token keyword">optional</span> <span class="token positional-class-name class-name">S2C</span> s2c <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><blockquote><ul><li>For stock structure refer to <a href="/moomoo-api-doc/en/quote/quote.html#5792">Security</a></li> <li>For candlestick structure, refer to <a href="/moomoo-api-doc/en/quote/quote.html#500">KLine</a></li> <li>For interface result, refer to <a href="/moomoo-api-doc/en/ftapi/common.html#8800">RetType</a></li></ul></blockquote> <ul><li><strong>Example</strong></li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Program</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">FTSPI_Qot</span><span class="token punctuation">,</span> <span class="token keyword">public</span> <span class="token class-name">FTSPI_Trd</span><span class="token punctuation">,</span> <span class="token keyword">public</span> <span class="token class-name">FTSPI_Conn</span></span>
<span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>

	<span class="token function">Program</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		m_pQotApi <span class="token operator">=</span> <span class="token class-name">FTAPI</span><span class="token double-colon punctuation">::</span><span class="token function">CreateQotApi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		m_pQotApi<span class="token operator">-&gt;</span><span class="token function">RegisterQotSpi</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		m_pQotApi<span class="token operator">-&gt;</span><span class="token function">RegisterConnSpi</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token operator">~</span><span class="token function">Program</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>m_pQotApi <span class="token operator">!=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			m_pQotApi<span class="token operator">-&gt;</span><span class="token function">UnregisterQotSpi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			m_pQotApi<span class="token operator">-&gt;</span><span class="token function">UnregisterConnSpi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">FTAPI</span><span class="token double-colon punctuation">::</span><span class="token function">ReleaseQotApi</span><span class="token punctuation">(</span>m_pQotApi<span class="token punctuation">)</span><span class="token punctuation">;</span>
			m_pQotApi <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">void</span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		m_pQotApi<span class="token operator">-&gt;</span><span class="token function">InitConnect</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span> <span class="token number">11111</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>


	<span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">OnInitConnect</span><span class="token punctuation">(</span>FTAPI_Conn<span class="token operator">*</span> pConn<span class="token punctuation">,</span> Futu<span class="token double-colon punctuation">::</span>i64_t nErrCode<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> strDesc<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;connect&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

		<span class="token comment">// construct request message</span>
		Qot_RequestHistoryKL<span class="token double-colon punctuation">::</span>Request req<span class="token punctuation">;</span>
		Qot_RequestHistoryKL<span class="token double-colon punctuation">::</span>C2S <span class="token operator">*</span>c2s <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">mutable_c2s</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		c2s<span class="token operator">-&gt;</span><span class="token function">set_rehabtype</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		c2s<span class="token operator">-&gt;</span><span class="token function">set_kltype</span><span class="token punctuation">(</span>Qot_Common<span class="token double-colon punctuation">::</span>KLType<span class="token double-colon punctuation">::</span>KLType_1Min<span class="token punctuation">)</span><span class="token punctuation">;</span>
		Qot_Common<span class="token double-colon punctuation">::</span>Security <span class="token operator">*</span>sec <span class="token operator">=</span> c2s<span class="token operator">-&gt;</span><span class="token function">mutable_security</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		sec<span class="token operator">-&gt;</span><span class="token function">set_code</span><span class="token punctuation">(</span><span class="token string">&quot;00700&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		sec<span class="token operator">-&gt;</span><span class="token function">set_market</span><span class="token punctuation">(</span>Qot_Common<span class="token double-colon punctuation">::</span>QotMarket<span class="token double-colon punctuation">::</span>QotMarket_HK_Security<span class="token punctuation">)</span><span class="token punctuation">;</span>
		c2s<span class="token operator">-&gt;</span><span class="token function">set_begintime</span><span class="token punctuation">(</span><span class="token string">&quot;2021-06-07&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		c2s<span class="token operator">-&gt;</span><span class="token function">set_endtime</span><span class="token punctuation">(</span><span class="token string">&quot;2021-07-01&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        m_RequestHistoryKLSerialNo <span class="token operator">=</span> m_pQotApi<span class="token operator">-&gt;</span><span class="token function">RequestHistoryKL</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Request RequestHistoryKL SerialNo: &quot;</span> <span class="token operator">&lt;&lt;</span> m_RequestHistoryKLSerialNo <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">OnReply_RequestHistoryKL</span><span class="token punctuation">(</span>Futu<span class="token double-colon punctuation">::</span>u32_t nSerialNo<span class="token punctuation">,</span> <span class="token keyword">const</span> Qot_RequestHistoryKL<span class="token double-colon punctuation">::</span>Response <span class="token operator">&amp;</span>stRsp<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>nSerialNo <span class="token operator">==</span> m_RequestHistoryKLSerialNo<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;OnReply_RequestHistoryKL SerialNo: &quot;</span> <span class="token operator">&lt;&lt;</span> nSerialNo <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> 
			<span class="token comment">// print response</span>
			<span class="token comment">// ProtoBufToBodyData and UTF8ToLocal refer to tool.h in Samples</span>
            string resp_str<span class="token punctuation">;</span>
            <span class="token function">ProtoBufToBodyData</span><span class="token punctuation">(</span>stRsp<span class="token punctuation">,</span> resp_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token function">UTF8ToLocal</span><span class="token punctuation">(</span>resp_str<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

<span class="token keyword">protected</span><span class="token operator">:</span>
	FTAPI_Qot <span class="token operator">*</span>m_pQotApi<span class="token punctuation">;</span>
    
    Futu<span class="token double-colon punctuation">::</span>u32_t m_RequestHistoryKLSerialNo<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int32_t</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">*</span> argv<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token class-name">FTAPI</span><span class="token double-colon punctuation">::</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token punctuation">{</span>
		Program program<span class="token punctuation">;</span>
		program<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	protobuf<span class="token double-colon punctuation">::</span><span class="token function">ShutdownProtobufLibrary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">FTAPI</span><span class="token double-colon punctuation">::</span><span class="token function">UnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br></div></div><ul><li><strong>Output</strong></li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>connect
Request RequestHistoryKL SerialNo: 3
OnReply_RequestHistoryKL SerialNo: 3
{
 &quot;retType&quot;: 0,
 &quot;retMsg&quot;: &quot;&quot;,
 &quot;errCode&quot;: 0,
 &quot;s2c&quot;: {
  &quot;security&quot;: {
   &quot;market&quot;: 1,
   &quot;code&quot;: &quot;00700&quot;
  },
  &quot;klList&quot;: [
   {
    &quot;time&quot;: &quot;2021-06-07 09:30:00&quot;,
    &quot;isBlank&quot;: false,
    &quot;highPrice&quot;: 611,
    &quot;openPrice&quot;: 611,
    &quot;lowPrice&quot;: 611,
    &quot;closePrice&quot;: 611,
    &quot;lastClosePrice&quot;: 611.5,
    &quot;volume&quot;: &quot;250100&quot;,
    &quot;turnover&quot;: 152811100,
    &quot;turnoverRate&quot;: 0,
    &quot;pe&quot;: 0,
    &quot;changeRate&quot;: -0.081766148814390843,
    &quot;timestamp&quot;: 1623029400
   },
   {
    &quot;time&quot;: &quot;2021-06-07 09:31:00&quot;,
    &quot;isBlank&quot;: false,
    &quot;highPrice&quot;: 611.5,
    &quot;openPrice&quot;: 611,
    &quot;lowPrice&quot;: 609,
    &quot;closePrice&quot;: 609.5,
    &quot;lastClosePrice&quot;: 611,
    &quot;volume&quot;: &quot;230700&quot;,
    &quot;turnover&quot;: 140792100,
    &quot;turnoverRate&quot;: 0,
    &quot;pe&quot;: 0,
    &quot;changeRate&quot;: -0.24549918166939444,
    &quot;timestamp&quot;: 1623029460
   },
...
   {
    &quot;time&quot;: &quot;2021-06-09 14:14:00&quot;,
    &quot;isBlank&quot;: false,
    &quot;highPrice&quot;: 601,
    &quot;openPrice&quot;: 600.5,
    &quot;lowPrice&quot;: 600,
    &quot;closePrice&quot;: 601,
    &quot;lastClosePrice&quot;: 600,
    &quot;volume&quot;: &quot;19300&quot;,
    &quot;turnover&quot;: 11589150,
    &quot;turnoverRate&quot;: 0,
    &quot;pe&quot;: 0,
    &quot;changeRate&quot;: 0.16666666666666669,
    &quot;timestamp&quot;: 1623219240
   }
  ]
 }
}

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br></div></div></div><div class="tab-content" style="display:none;"><p><code>RequestHistoryKL(req);</code></p> <ul><li><p><strong>Description</strong></p> <p>Get historical candlesticks</p></li> <li><p><strong>Parameters</strong></p></li></ul> <div class="language-protobuf line-numbers-mode"><pre class="language-protobuf"><code>
<span class="token keyword">message</span> <span class="token class-name">C2S</span>
<span class="token punctuation">{</span>
    <span class="token keyword">required</span> <span class="token builtin">int32</span> rehabType <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//Qot_Common.RehabType, rehabilitation type</span>
    <span class="token keyword">required</span> <span class="token builtin">int32</span> klType <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">//Qot_Common.KLType, timeframe of candlestick</span>
    <span class="token keyword">required</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>Security</span> security <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">//Security code</span>
    <span class="token keyword">required</span> <span class="token builtin">string</span> beginTime <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">//Start time string (Format: yyyy-MM-dd)</span>
    <span class="token keyword">required</span> <span class="token builtin">string</span> endTime <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">//End time string (Format: yyyy-MM-dd)</span>
    <span class="token keyword">optional</span> <span class="token builtin">int32</span> maxAckKLNum <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span> <span class="token comment">//How many candlesticks can be returned at most, if not specified, it means no limit</span>
    <span class="token keyword">optional</span> <span class="token builtin">int64</span> needKLFieldsFlag <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span> <span class="token comment">//Specific fields of candlestick structure to return. A combination of KLFields enumeratio. If not specified, return all fields</span>
    <span class="token keyword">optional</span> <span class="token builtin">bytes</span> nextReqKey <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token comment">//Paging request key</span>
    <span class="token keyword">optional</span> <span class="token builtin">bool</span> extendedTime <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span> <span class="token comment">//Whether to get the pre-market and after-hours currently only supports timeframes of 60-minutes and below.</span>
    <span class="token keyword">optional</span> <span class="token builtin">int32</span> session <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">//Get non-regular data of US stocks, currently only supports timeframes of 60-minutes and below.</span>
<span class="token punctuation">}</span>

<span class="token keyword">message</span> <span class="token class-name">Request</span>
<span class="token punctuation">{</span>
	<span class="token keyword">required</span> <span class="token positional-class-name class-name">C2S</span> c2s <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><blockquote><ul><li>For stock structure refer to <a href="/moomoo-api-doc/en/quote/quote.html#5792">Security</a></li> <li>For stock adjustment type, refer to <a href="/moomoo-api-doc/en/quote/quote.html#7071">RehabType</a></li> <li>For candlestick type, refer to <a href="/moomoo-api-doc/en/quote/quote.html#66">KLType</a></li> <li>For candlestick structure, refer to <a href="/moomoo-api-doc/en/quote/quote.html#5803">KLFields</a></li></ul></blockquote> <ul><li><strong>Return</strong></li></ul> <div class="language-protobuf line-numbers-mode"><pre class="language-protobuf"><code>
<span class="token keyword">message</span> <span class="token class-name">S2C</span>
<span class="token punctuation">{</span>
    <span class="token keyword">required</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>Security</span> security <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//Security</span>
    <span class="token keyword">optional</span> <span class="token builtin">string</span> name <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">// Stock name</span>
    <span class="token keyword">repeated</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>KLine</span> klList <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">//Candlestick data</span>
    <span class="token keyword">optional</span> <span class="token builtin">bytes</span> nextReqKey <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">//Paging request key.</span>
<span class="token punctuation">}</span>

<span class="token keyword">message</span> <span class="token class-name">Response</span>
<span class="token punctuation">{</span>
	<span class="token keyword">required</span> <span class="token builtin">int32</span> retType <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">[</span><span class="token annotation">default</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">400</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//RetType, returned value</span>
	<span class="token keyword">optional</span> <span class="token builtin">string</span> retMsg <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">optional</span> <span class="token builtin">int32</span> errCode <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
	
	<span class="token keyword">optional</span> <span class="token positional-class-name class-name">S2C</span> s2c <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><blockquote><ul><li>For stock structure refer to <a href="/moomoo-api-doc/en/quote/quote.html#5792">Security</a></li> <li>For candlestick structure, refer to <a href="/moomoo-api-doc/en/quote/quote.html#500">KLine</a></li> <li>For interface result, refer to <a href="/moomoo-api-doc/en/ftapi/common.html#8800">RetType</a></li></ul></blockquote> <ul><li><strong>Example</strong></li></ul> <div class="language-JavaScript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> ftWebsocket <span class="token keyword">from</span> <span class="token string">&quot;futu-api&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ftCmdID <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;futu-api&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Common<span class="token punctuation">,</span> Qot_Common <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;futu-api/proto&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> beautify <span class="token keyword">from</span> <span class="token string">&quot;js-beautify&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">QotRequestHistoryKL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> RetType <span class="token punctuation">}</span> <span class="token operator">=</span> Common
    <span class="token keyword">const</span> <span class="token punctuation">{</span> RehabType<span class="token punctuation">,</span> KLType<span class="token punctuation">,</span> SubType<span class="token punctuation">,</span> QotMarket <span class="token punctuation">}</span> <span class="token operator">=</span> Qot_Common
    <span class="token keyword">let</span> <span class="token punctuation">[</span>addr<span class="token punctuation">,</span> port<span class="token punctuation">,</span> enable_ssl<span class="token punctuation">,</span> key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span> <span class="token number">33333</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">'7522027ccf5a06b1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> websocket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ftWebsocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    websocket<span class="token punctuation">.</span><span class="token function-variable function">onlogin</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">ret<span class="token punctuation">,</span> msg</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>ret<span class="token punctuation">)</span> <span class="token punctuation">{</span> 

            <span class="token keyword">const</span> req <span class="token operator">=</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">c2s</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token literal-property property">rehabType</span><span class="token operator">:</span> RehabType<span class="token punctuation">.</span>RehabType_None<span class="token punctuation">,</span> 
                    <span class="token literal-property property">klType</span><span class="token operator">:</span> KLType<span class="token punctuation">.</span>KLType_Day<span class="token punctuation">,</span>
                    <span class="token literal-property property">security</span><span class="token operator">:</span><span class="token punctuation">{</span>
                        <span class="token literal-property property">market</span><span class="token operator">:</span> QotMarket<span class="token punctuation">.</span>QotMarket_HK_Security<span class="token punctuation">,</span>
                        <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token string">&quot;00700&quot;</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">beginTime</span><span class="token operator">:</span> <span class="token string">&quot;2021-08-05&quot;</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">endTime</span><span class="token operator">:</span> <span class="token string">&quot;2021-08-10&quot;</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            
            websocket<span class="token punctuation">.</span><span class="token function">RequestHistoryKL</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">let</span> <span class="token punctuation">{</span> errCode<span class="token punctuation">,</span> retMsg<span class="token punctuation">,</span> retType<span class="token punctuation">,</span>s2c <span class="token punctuation">}</span> <span class="token operator">=</span> res
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;HistoryKL: errCode %d, retMsg %s, retType %d&quot;</span><span class="token punctuation">,</span> errCode<span class="token punctuation">,</span> retMsg<span class="token punctuation">,</span> retType<span class="token punctuation">)</span><span class="token punctuation">;</span> 
                <span class="token keyword">if</span><span class="token punctuation">(</span>retType <span class="token operator">==</span> RetType<span class="token punctuation">.</span>RetType_Succeed<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token function">beautify</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>s2c<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                        <span class="token literal-property property">indent_size</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">space_in_empty_paren</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;error:&quot;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    websocket<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span>addr<span class="token punctuation">,</span> port<span class="token punctuation">,</span> enable_ssl<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// After using the connection, remember to close it to prevent the number of connections from running out</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span> 
        websocket<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;stop&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Set the script to receive OpenD push duration to 5 seconds</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><ul><li><strong>Output</strong></li></ul> <div class="language-JavaScript line-numbers-mode"><pre class="language-javascript"><code><span class="token literal-property property">OwnerPlate</span><span class="token operator">:</span> errCode <span class="token number">0</span><span class="token punctuation">,</span> retMsg <span class="token punctuation">,</span> retType <span class="token number">0</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;security&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;market&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;00700&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;klList&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    <span class="token string-property property">&quot;time&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-08-05 00:00:00&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;isBlank&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;highPrice&quot;</span><span class="token operator">:</span> <span class="token number">464.4</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;openPrice&quot;</span><span class="token operator">:</span> <span class="token number">452.6</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;lowPrice&quot;</span><span class="token operator">:</span> <span class="token number">432.6</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;closePrice&quot;</span><span class="token operator">:</span> <span class="token number">439</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;lastClosePrice&quot;</span><span class="token operator">:</span> <span class="token number">456.8</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;volume&quot;</span><span class="token operator">:</span> <span class="token string">&quot;58625939&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;turnover&quot;</span><span class="token operator">:</span> <span class="token number">26193545519</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;turnoverRate&quot;</span><span class="token operator">:</span> <span class="token number">0.00611</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;pe&quot;</span><span class="token operator">:</span> <span class="token number">22.137</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;changeRate&quot;</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">3.896672504378286</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token number">1628092800</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;time&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-08-06 00:00:00&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;isBlank&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;highPrice&quot;</span><span class="token operator">:</span> <span class="token number">460.4</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;openPrice&quot;</span><span class="token operator">:</span> <span class="token number">444.8</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;lowPrice&quot;</span><span class="token operator">:</span> <span class="token number">440</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;closePrice&quot;</span><span class="token operator">:</span> <span class="token number">453.6</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;lastClosePrice&quot;</span><span class="token operator">:</span> <span class="token number">439</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;volume&quot;</span><span class="token operator">:</span> <span class="token string">&quot;42946505&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;turnover&quot;</span><span class="token operator">:</span> <span class="token number">19468783995</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;turnoverRate&quot;</span><span class="token operator">:</span> <span class="token number">0.00447</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;pe&quot;</span><span class="token operator">:</span> <span class="token number">22.873</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;changeRate&quot;</span><span class="token operator">:</span> <span class="token number">3.3257403189066106</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token number">1628179200</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;time&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-08-09 00:00:00&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;isBlank&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;highPrice&quot;</span><span class="token operator">:</span> <span class="token number">472.4</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;openPrice&quot;</span><span class="token operator">:</span> <span class="token number">447.8</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;lowPrice&quot;</span><span class="token operator">:</span> <span class="token number">442.6</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;closePrice&quot;</span><span class="token operator">:</span> <span class="token number">461.6</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;lastClosePrice&quot;</span><span class="token operator">:</span> <span class="token number">453.6</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;volume&quot;</span><span class="token operator">:</span> <span class="token string">&quot;40956433&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;turnover&quot;</span><span class="token operator">:</span> <span class="token number">18847164570</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;turnoverRate&quot;</span><span class="token operator">:</span> <span class="token number">0.00427</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;pe&quot;</span><span class="token operator">:</span> <span class="token number">23.276</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;changeRate&quot;</span><span class="token operator">:</span> <span class="token number">1.763668430335097</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token number">1628438400</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;time&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-08-10 00:00:00&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;isBlank&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;highPrice&quot;</span><span class="token operator">:</span> <span class="token number">493</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;openPrice&quot;</span><span class="token operator">:</span> <span class="token number">478</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;lowPrice&quot;</span><span class="token operator">:</span> <span class="token number">473.2</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;closePrice&quot;</span><span class="token operator">:</span> <span class="token number">486.2</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;lastClosePrice&quot;</span><span class="token operator">:</span> <span class="token number">461.6</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;volume&quot;</span><span class="token operator">:</span> <span class="token string">&quot;40881986&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;turnover&quot;</span><span class="token operator">:</span> <span class="token number">19749306230</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;turnoverRate&quot;</span><span class="token operator">:</span> <span class="token number">0.00426</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;pe&quot;</span><span class="token operator">:</span> <span class="token number">24.517</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;changeRate&quot;</span><span class="token operator">:</span> <span class="token number">5.329289428076249</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token number">1628524800</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
stop
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br></div></div></div></div> <div class="custom-block tip"><p class="custom-block-title">Interface Restrictions</p> <ul><li>Candlestick data with timeframes of <strong>60 minutes and below</strong>, is only supported for the last 8 years. <strong>Daily</strong> candlestick data is supported for the last 20 years. <strong>Daily above</strong> candlestick data is not restricted.</li> <li>We will issue historical candlestick quota based on your account assets and transaction conditions. Therefore, you can only obtain historical candlestick data for a limited number of stocks within 30 days. For specific rules, please refer to <a href="/moomoo-api-doc/en/intro/authority.html#9123">Subscription Quota &amp; Historical Candlestick Quota</a>. The historical candlestick quota you consume on that day will be automatically released after 30 days.</li> <li>A maximum of 60 requests per 30 seconds. Note: If you obtain data by page, this frequency limit rule is only applicable to the first time calling the interface, and subsequent pages request frequency is unlimited.</li> <li><em>Change rate</em>, only supports timeframes of daily and above.</li> <li><strong>Options</strong> related candlestick data, only supports 1 day, 1 minute, 5 minutes, 15 minutes and 60 minutes.</li> <li>The pre-market, after-hours and overnight candlestick of US stocks, only supports timeframes of 60 minutes and below. Since the pre-market, after-hours and overnight session of the US stock market are irregular trading hours, the candlestick data for this period may be less than 2 years.</li> <li><em>Turnover</em> of US stocks, only supports data after 2015-10-12.</li></ul></div></div><div class="tab-content" style="display:;"><div class="ft-switcher"><div class="tab-header" style="display:none;"><ul><li class="active"> Python
            </li><li> Proto
            </li><li> C#
            </li><li> Java
            </li><li> C++
            </li><li> JavaScript
            </li></ul></div> <div class="tab-content" style="display:;"><p><code>request_history_kline(code, start=None, end=None, ktype=KLType.K_DAY, autype=AuType.QFQ, fields=[KL_FIELD.ALL], max_count=1000, page_req_key=None, extended_time=False)</code></p> <ul><li><p><strong>Description</strong></p> <p>Get historical candlesticks</p></li> <li><p><strong>Parameters</strong></p> <table><thead><tr><th style="text-align:left;">Parameter</th> <th style="text-align:left;">Type</th> <th style="text-align:left;">Description</th></tr></thead> <tbody><tr><td style="text-align:left;">code</td> <td style="text-align:left;">str</td> <td style="text-align:left;">Stock code.</td></tr> <tr><td style="text-align:left;">start</td> <td style="text-align:left;">str</td> <td style="text-align:left;">Start time. <div class="fttip-wrapper"><button type="button" class="fttip-title"><span> </span> <img src="/moomoo-api-doc/img/tip.png" class="tip"></button> <div class="fttip-dropdown" style="display:none;"><div class="fttip-layout"><span class="fttip-uparrow"></span> <span class="fttip-uparrow2"></span> <div class="fttip-content">Format: yyyy-MM-dd<br>For example: &quot;2017-06-20&quot;.</div></div></div></div></td></tr> <tr><td style="text-align:left;">end</td> <td style="text-align:left;">str</td> <td style="text-align:left;">End time. <div class="fttip-wrapper"><button type="button" class="fttip-title"><span> </span> <img src="/moomoo-api-doc/img/tip.png" class="tip"></button> <div class="fttip-dropdown" style="display:none;"><div class="fttip-layout"><span class="fttip-uparrow"></span> <span class="fttip-uparrow2"></span> <div class="fttip-content">Format: yyyy-MM-dd<br>For example: &quot;2017-07-20&quot;.</div></div></div></div></td></tr> <tr><td style="text-align:left;">ktype</td> <td style="text-align:left;"><a href="/moomoo-api-doc/en/quote/quote.html#66">KLType</a></td> <td style="text-align:left;">Candlestick type.</td></tr> <tr><td style="text-align:left;">autype</td> <td style="text-align:left;"><a href="/moomoo-api-doc/en/quote/quote.html#7071">AuType</a></td> <td style="text-align:left;">Type of adjustment.</td></tr> <tr><td style="text-align:left;">fields</td> <td style="text-align:left;"><a href="/moomoo-api-doc/en/quote/quote.html#5803">KL_FIELD</a></td> <td style="text-align:left;">List of fields to be returned.</td></tr> <tr><td style="text-align:left;">max_count</td> <td style="text-align:left;">int</td> <td style="text-align:left;">The maximum number of candlesticks returned in this request. <div class="fttip-wrapper"><button type="button" class="fttip-title"><span> </span> <img src="/moomoo-api-doc/img/tip.png" class="tip"></button> <div class="fttip-dropdown" style="display:none;"><div class="fttip-layout"><span class="fttip-uparrow"></span> <span class="fttip-uparrow2"></span> <div class="fttip-content"><ul><li>Sending None indicates that all data between start and end is returned. </li><li>Note: OpenD requests all the data and then sends it to the script. If the number of candlesticks you want to obtain is more than 1000, it is recommended to select paging to prevent from timeout.</li></ul></div></div></div></div></td></tr> <tr><td style="text-align:left;">page_req_key</td> <td style="text-align:left;">bytes</td> <td style="text-align:left;">The key of the page request. If the number of candlesticks between start and end is more than max_count, then None should be passed at the first time you call this interface, and the page_req_key returned by the last call must be passed in the subsequent pagerequests.</td></tr> <tr><td style="text-align:left;">extended_time</td> <td style="text-align:left;">bool</td> <td style="text-align:left;">Need pre-market and after-hours data for US stocks or not. False: not need, True: need.</td></tr> <tr><td style="text-align:left;">session</td> <td style="text-align:left;"><a href="/moomoo-api-doc/en/quote/quote.html#8688">Session</a></td> <td style="text-align:left;">Get US stocks historical k-line in session <div class="fttip-wrapper"><button type="button" class="fttip-title"><span> </span> <img src="/moomoo-api-doc/img/tip.png" class="tip"></button> <div class="fttip-dropdown" style="display:none;"><div class="fttip-layout"><span class="fttip-uparrow"></span> <span class="fttip-uparrow2"></span> <div class="fttip-content"><ul><li>Only used to get historical k-line for US stocks in session.</li></ul><ul><li>If you want to get 24H historical k-line data of US stocks, please use 'ALL'. The 'OVERNIGHT' is not allowed.</li></ul><ul><li>Minimum version requirements: 9.2.4207</li></ul></div></div></div></div></td></tr></tbody></table> <ul><li>The combination of <em><strong>start</strong></em> and <em><strong>end</strong></em> is as follows
<table><thead><tr><th style="text-align:left;">Start type</th> <th style="text-align:left;">End type</th> <th style="text-align:left;">Description</th></tr></thead> <tbody><tr><td style="text-align:left;">str</td> <td style="text-align:left;">str</td> <td style="text-align:left;"><em><strong>start</strong></em> and <em><strong>end</strong></em> are the specified dates respectively.</td></tr> <tr><td style="text-align:left;">None</td> <td style="text-align:left;">str</td> <td style="text-align:left;"><em><strong>start</strong></em> is 365 days before <em><strong>end</strong></em>.</td></tr> <tr><td style="text-align:left;">str</td> <td style="text-align:left;">None</td> <td style="text-align:left;"><em><strong>end</strong></em> is 365 days after <em><strong>start</strong></em>.</td></tr> <tr><td style="text-align:left;">None</td> <td style="text-align:left;">None</td> <td style="text-align:left;"><em><strong>end</strong></em> is the current date, <em><strong>start</strong></em> is 365 days before.</td></tr></tbody></table></li></ul></li></ul> <ul><li><p><strong>Return</strong></p> <table><tr><th>Field</th> <th>Type</th> <th>Description</th></tr> <tr><td>ret</td> <td><a href="../ftapi/common.html#8800"> RET_CODE</a></td> <td>Interface result.</td></tr> <tr><td rowspan="2">data</td> <td>pd.DataFrame</td> <td>If ret == RET_OK, historical candlestick data is returned.</td></tr> <tr><td>str</td> <td>If ret != RET_OK, error description is returned.</td></tr> <tr><td>page_req_key</td> <td>bytes</td> <td>The key of the next page request.</td></tr></table> <ul><li>Historical candlestick data format as follows:
<table><thead><tr><th style="text-align:left;">Field</th> <th style="text-align:left;">Type</th> <th style="text-align:left;">Description</th></tr></thead> <tbody><tr><td style="text-align:left;">code</td> <td style="text-align:left;">str</td> <td style="text-align:left;">Stock code.</td></tr> <tr><td style="text-align:left;">name</td> <td style="text-align:left;">str</td> <td style="text-align:left;">Stock name.</td></tr> <tr><td style="text-align:left;">time_key</td> <td style="text-align:left;">str</td> <td style="text-align:left;">Candlestick time. <div class="fttip-wrapper"><button type="button" class="fttip-title"><span> </span> <img src="/moomoo-api-doc/img/tip.png" class="tip"></button> <div class="fttip-dropdown" style="display:none;"><div class="fttip-layout"><span class="fttip-uparrow"></span> <span class="fttip-uparrow2"></span> <div class="fttip-content">Format: yyyy-MM-dd HH:mm:ss<br>The default of HK stock market and A-share market is Beijing time, while that of US stock market is US Eastern time.</div></div></div></div></td></tr> <tr><td style="text-align:left;">open</td> <td style="text-align:left;">float</td> <td style="text-align:left;">Open.</td></tr> <tr><td style="text-align:left;">close</td> <td style="text-align:left;">float</td> <td style="text-align:left;">Close.</td></tr> <tr><td style="text-align:left;">high</td> <td style="text-align:left;">float</td> <td style="text-align:left;">High.</td></tr> <tr><td style="text-align:left;">low</td> <td style="text-align:left;">float</td> <td style="text-align:left;">Low.</td></tr> <tr><td style="text-align:left;">pe_ratio</td> <td style="text-align:left;">float</td> <td style="text-align:left;">P/E ratio. <div class="fttip-wrapper"><button type="button" class="fttip-title"><span> </span> <img src="/moomoo-api-doc/img/tip.png" class="tip"></button> <div class="fttip-dropdown" style="display:none;"><div class="fttip-layout"><span class="fttip-uparrow"></span> <span class="fttip-uparrow2"></span> <div class="fttip-content">This field is a ratio field, and % is not displayed.</div></div></div></div></td></tr> <tr><td style="text-align:left;">turnover_rate</td> <td style="text-align:left;">float</td> <td style="text-align:left;">Turnover rate.</td></tr> <tr><td style="text-align:left;">volume</td> <td style="text-align:left;">int</td> <td style="text-align:left;">Volume.</td></tr> <tr><td style="text-align:left;">turnover</td> <td style="text-align:left;">float</td> <td style="text-align:left;">Turnover.</td></tr> <tr><td style="text-align:left;">change_rate</td> <td style="text-align:left;">float</td> <td style="text-align:left;">Change rate.</td></tr> <tr><td style="text-align:left;">last_close</td> <td style="text-align:left;">float</td> <td style="text-align:left;">Yesterday's close.</td></tr></tbody></table></li></ul></li> <li><p><strong>Example</strong></p></li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> moomoo <span class="token keyword">import</span> <span class="token operator">*</span>
quote_ctx <span class="token operator">=</span> OpenQuoteContext<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">11111</span><span class="token punctuation">)</span>
ret<span class="token punctuation">,</span> data<span class="token punctuation">,</span> page_req_key <span class="token operator">=</span> quote_ctx<span class="token punctuation">.</span>request_history_kline<span class="token punctuation">(</span><span class="token string">'US.AAPL'</span><span class="token punctuation">,</span> start<span class="token operator">=</span><span class="token string">'2019-09-11'</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">'2019-09-18'</span><span class="token punctuation">,</span> max_count<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment"># 5 per page, request the first page</span>
<span class="token keyword">if</span> ret <span class="token operator">==</span> RET_OK<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># Take the first stock code</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'close'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># The closing price of the first page is converted to a list</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'error:'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
<span class="token keyword">while</span> page_req_key <span class="token operator">!=</span> <span class="token boolean">None</span><span class="token punctuation">:</span> <span class="token comment"># Request all results after</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'*************************************'</span><span class="token punctuation">)</span>
    ret<span class="token punctuation">,</span> data<span class="token punctuation">,</span> page_req_key <span class="token operator">=</span> quote_ctx<span class="token punctuation">.</span>request_history_kline<span class="token punctuation">(</span><span class="token string">'US.AAPL'</span><span class="token punctuation">,</span> start<span class="token operator">=</span><span class="token string">'2019-09-11'</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">'2019-09-18'</span><span class="token punctuation">,</span> max_count<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>page_req_key<span class="token operator">=</span>page_req_key<span class="token punctuation">)</span> <span class="token comment"># Request the page after turning data</span>
    <span class="token keyword">if</span> ret <span class="token operator">==</span> RET_OK<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'error:'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'All pages are finished!'</span><span class="token punctuation">)</span>
quote_ctx<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># After using the connection, remember to close it to prevent the number of connections from running out</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><ul><li><strong>Output</strong></li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code>code  name             time_key       <span class="token builtin">open</span>      close       high        low  pe_ratio  turnover_rate    volume      turnover  change_rate  last_close
<span class="token number">0</span>  US<span class="token punctuation">.</span>AAPL   APPLE  <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">11</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span>  <span class="token number">52.631194</span>  <span class="token number">53.963447</span>  <span class="token number">53.992409</span>  <span class="token number">52.549135</span>    <span class="token number">18.773</span>        <span class="token number">0.01039</span>  <span class="token number">177158584</span>  <span class="token number">9.808562e+09</span>     <span class="token number">3.179511</span>   <span class="token number">52.300545</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span>       <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>       <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>       <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>          <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>         <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token number">4</span>  US<span class="token punctuation">.</span>AAPL   APPLE  <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span>  <span class="token number">53.087346</span>  <span class="token number">53.265945</span>  <span class="token number">53.294907</span>  <span class="token number">52.884612</span>    <span class="token number">18.530</span>        <span class="token number">0.00432</span>   <span class="token number">73545872</span>  <span class="token number">4.046314e+09</span>     <span class="token number">0.363802</span>   <span class="token number">53.072865</span>

<span class="token punctuation">[</span><span class="token number">5</span> rows x <span class="token number">13</span> columns<span class="token punctuation">]</span>
US<span class="token punctuation">.</span>AAPL
<span class="token punctuation">[</span><span class="token number">53.9634465</span><span class="token punctuation">,</span> <span class="token number">53.84156475</span><span class="token punctuation">,</span> <span class="token number">52.7953125</span><span class="token punctuation">,</span> <span class="token number">53.072865</span><span class="token punctuation">,</span> <span class="token number">53.265945</span><span class="token punctuation">]</span>
<span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">*</span>
       code  name             time_key       <span class="token builtin">open</span>      close       high        low  pe_ratio  turnover_rate   volume      turnover  change_rate  last_close
<span class="token number">0</span>  US<span class="token punctuation">.</span>AAPL   APPLE  <span class="token number">2019</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">18</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">:</span><span class="token number">00</span>  <span class="token number">53.352831</span>  <span class="token number">53.76554</span>  <span class="token number">53.784847</span>  <span class="token number">52.961844</span>    <span class="token number">18.704</span>        <span class="token number">0.00602</span>  <span class="token number">102572372</span>  <span class="token number">5.682068e+09</span>     <span class="token number">0.937925</span>   <span class="token number">53.265945</span>
All pages are finished!
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></div><div class="tab-content" style="display:none;"><h2 id="4609-2"><a href="#4609-2" class="header-anchor">#</a> Qot_RequestHistoryKL.proto</h2> <ul><li><p><strong>Description</strong></p> <p>Get historical candlestics</p></li> <li><p><strong>Parameters</strong></p></li></ul> <div class="language-protobuf line-numbers-mode"><pre class="language-protobuf"><code>
<span class="token keyword">message</span> <span class="token class-name">C2S</span>
<span class="token punctuation">{</span>
    <span class="token keyword">required</span> <span class="token builtin">int32</span> rehabType <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//Qot_Common.RehabType, rehabilitation type</span>
    <span class="token keyword">required</span> <span class="token builtin">int32</span> klType <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">//Qot_Common.KLType, timeframe of candlestick</span>
    <span class="token keyword">required</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>Security</span> security <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">//Security code</span>
    <span class="token keyword">required</span> <span class="token builtin">string</span> beginTime <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">//Start time string (Format: yyyy-MM-dd)</span>
    <span class="token keyword">required</span> <span class="token builtin">string</span> endTime <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">//End time string (Format: yyyy-MM-dd)</span>
    <span class="token keyword">optional</span> <span class="token builtin">int32</span> maxAckKLNum <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span> <span class="token comment">//How many candlesticks can be returned at most, if not specified, it means no limit</span>
    <span class="token keyword">optional</span> <span class="token builtin">int64</span> needKLFieldsFlag <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span> <span class="token comment">//Specific fields of candlestick structure to return. A combination of KLFields enumeratio. If not specified, return all fields</span>
    <span class="token keyword">optional</span> <span class="token builtin">bytes</span> nextReqKey <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token comment">//Paging request key</span>
    <span class="token keyword">optional</span> <span class="token builtin">bool</span> extendedTime <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span> <span class="token comment">//Whether to get the pre-market and after-hours currently only supports timeframes of 60-minutes and below.</span>
    <span class="token keyword">optional</span> <span class="token builtin">int32</span> session <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">//Get non-regular data of US stocks, currently only supports timeframes of 60-minutes and below.</span>
<span class="token punctuation">}</span>

<span class="token keyword">message</span> <span class="token class-name">Request</span>
<span class="token punctuation">{</span>
	<span class="token keyword">required</span> <span class="token positional-class-name class-name">C2S</span> c2s <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><blockquote><ul><li>For stock structure refer to <a href="/moomoo-api-doc/en/quote/quote.html#5792">Security</a></li> <li>For stock adjustment type, refer to <a href="/moomoo-api-doc/en/quote/quote.html#7071">RehabType</a></li> <li>For candlestick type, refer to <a href="/moomoo-api-doc/en/quote/quote.html#66">KLType</a></li> <li>For candlestick structure, refer to <a href="/moomoo-api-doc/en/quote/quote.html#5803">KLFields</a></li></ul></blockquote> <ul><li><strong>Return</strong></li></ul> <div class="language-protobuf line-numbers-mode"><pre class="language-protobuf"><code>
<span class="token keyword">message</span> <span class="token class-name">S2C</span>
<span class="token punctuation">{</span>
    <span class="token keyword">required</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>Security</span> security <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//Security</span>
    <span class="token keyword">optional</span> <span class="token builtin">string</span> name <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">// Stock name</span>
    <span class="token keyword">repeated</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>KLine</span> klList <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">//Candlestick data</span>
    <span class="token keyword">optional</span> <span class="token builtin">bytes</span> nextReqKey <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">//Paging request key.</span>
<span class="token punctuation">}</span>

<span class="token keyword">message</span> <span class="token class-name">Response</span>
<span class="token punctuation">{</span>
	<span class="token keyword">required</span> <span class="token builtin">int32</span> retType <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">[</span><span class="token annotation">default</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">400</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//RetType, returned value</span>
	<span class="token keyword">optional</span> <span class="token builtin">string</span> retMsg <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">optional</span> <span class="token builtin">int32</span> errCode <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
	
	<span class="token keyword">optional</span> <span class="token positional-class-name class-name">S2C</span> s2c <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><blockquote><ul><li>For stock structure refer to <a href="/moomoo-api-doc/en/quote/quote.html#5792">Security</a></li> <li>For candlestick structure, refer to <a href="/moomoo-api-doc/en/quote/quote.html#500">KLine</a></li> <li>For interface result, refer to <a href="/moomoo-api-doc/en/ftapi/common.html#8800">RetType</a></li></ul></blockquote> <ul><li><p><strong>Protocol ID</strong></p> <p>3103</p></li></ul></div><div class="tab-content" style="display:none;"><p><code>uint RequestHistoryKL(QotRequestHistoryKL.Request req);</code><br> <code>virtual void OnReply_RequestHistoryKL(MMAPI_Conn client, uint nSerialNo, QotRequestHistoryKL.Response rsp);</code></p> <ul><li><p><strong>Description</strong></p> <p>Get historical candlesticks</p></li> <li><p><strong>Parameters</strong></p></li></ul> <div class="language-protobuf line-numbers-mode"><pre class="language-protobuf"><code>
<span class="token keyword">message</span> <span class="token class-name">C2S</span>
<span class="token punctuation">{</span>
    <span class="token keyword">required</span> <span class="token builtin">int32</span> rehabType <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//Qot_Common.RehabType, rehabilitation type</span>
    <span class="token keyword">required</span> <span class="token builtin">int32</span> klType <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">//Qot_Common.KLType, timeframe of candlestick</span>
    <span class="token keyword">required</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>Security</span> security <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">//Security code</span>
    <span class="token keyword">required</span> <span class="token builtin">string</span> beginTime <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">//Start time string (Format: yyyy-MM-dd)</span>
    <span class="token keyword">required</span> <span class="token builtin">string</span> endTime <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">//End time string (Format: yyyy-MM-dd)</span>
    <span class="token keyword">optional</span> <span class="token builtin">int32</span> maxAckKLNum <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span> <span class="token comment">//How many candlesticks can be returned at most, if not specified, it means no limit</span>
    <span class="token keyword">optional</span> <span class="token builtin">int64</span> needKLFieldsFlag <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span> <span class="token comment">//Specific fields of candlestick structure to return. A combination of KLFields enumeratio. If not specified, return all fields</span>
    <span class="token keyword">optional</span> <span class="token builtin">bytes</span> nextReqKey <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token comment">//Paging request key</span>
    <span class="token keyword">optional</span> <span class="token builtin">bool</span> extendedTime <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span> <span class="token comment">//Whether to get the pre-market and after-hours currently only supports timeframes of 60-minutes and below.</span>
    <span class="token keyword">optional</span> <span class="token builtin">int32</span> session <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">//Get non-regular data of US stocks, currently only supports timeframes of 60-minutes and below.</span>

<span class="token keyword">message</span> <span class="token class-name">Request</span>
<span class="token punctuation">{</span>
	<span class="token keyword">required</span> <span class="token positional-class-name class-name">C2S</span> c2s <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><blockquote><ul><li>For stock structure refer to <a href="/moomoo-api-doc/en/quote/quote.html#5792">Security</a></li> <li>For stock adjustment type, refer to <a href="/moomoo-api-doc/en/quote/quote.html#7071">RehabType</a></li> <li>For candlestick type, refer to <a href="/moomoo-api-doc/en/quote/quote.html#66">KLType</a></li> <li>For candlestick structure, refer to <a href="/moomoo-api-doc/en/quote/quote.html#5803">KLFields</a></li></ul></blockquote> <ul><li><strong>Return</strong></li></ul> <div class="language-protobuf line-numbers-mode"><pre class="language-protobuf"><code>
<span class="token keyword">message</span> <span class="token class-name">S2C</span>
<span class="token punctuation">{</span>
    <span class="token keyword">required</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>Security</span> security <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//Security</span>
    <span class="token keyword">optional</span> <span class="token builtin">string</span> name <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">// Stock name</span>
    <span class="token keyword">repeated</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>KLine</span> klList <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">//Candlestick data</span>
    <span class="token keyword">optional</span> <span class="token builtin">bytes</span> nextReqKey <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">//Paging request key.</span>
<span class="token punctuation">}</span>

<span class="token keyword">message</span> <span class="token class-name">Response</span>
<span class="token punctuation">{</span>
	<span class="token keyword">required</span> <span class="token builtin">int32</span> retType <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">[</span><span class="token annotation">default</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">400</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//RetType, returned value</span>
	<span class="token keyword">optional</span> <span class="token builtin">string</span> retMsg <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">optional</span> <span class="token builtin">int32</span> errCode <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
	
	<span class="token keyword">optional</span> <span class="token positional-class-name class-name">S2C</span> s2c <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><blockquote><ul><li>For stock structure refer to <a href="/moomoo-api-doc/en/quote/quote.html#5792">Security</a></li> <li>For candlestick structure, refer to <a href="/moomoo-api-doc/en/quote/quote.html#500">KLine</a></li> <li>For interface result, refer to <a href="/moomoo-api-doc/en/ftapi/common.html#8800">RetType</a></li></ul></blockquote> <ul><li><strong>Example</strong></li></ul> <div class="language-cs line-numbers-mode"><pre class="language-cs"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Program</span><span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MMSPI_Qot</span><span class="token punctuation">,</span> <span class="token class-name">MMSPI_Conn</span></span> <span class="token punctuation">{</span>
    <span class="token class-name">MMAPI_Qot</span> qot <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MMAPI_Qot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">Program</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        qot<span class="token punctuation">.</span><span class="token function">SetClientInfo</span><span class="token punctuation">(</span><span class="token string">&quot;csharp&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Set client information</span>
        qot<span class="token punctuation">.</span><span class="token function">SetConnCallback</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Set connection callback</span>
        qot<span class="token punctuation">.</span><span class="token function">SetQotCallback</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Set transaction callback</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        qot<span class="token punctuation">.</span><span class="token function">InitConnect</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">ushort</span><span class="token punctuation">)</span><span class="token number">11111</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnInitConnect</span><span class="token punctuation">(</span><span class="token class-name">MMAPI_Conn</span> client<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">long</span></span> errCode<span class="token punctuation">,</span> <span class="token class-name">String</span> desc<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">&quot;Qot onInitConnect: ret={0} desc={1} connID={2}\n&quot;</span><span class="token punctuation">,</span> errCode<span class="token punctuation">,</span> desc<span class="token punctuation">,</span> client<span class="token punctuation">.</span><span class="token function">GetConnectID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>errCode <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>

        <span class="token class-name">QotCommon<span class="token punctuation">.</span>Security</span> sec <span class="token operator">=</span> QotCommon<span class="token punctuation">.</span>Security<span class="token punctuation">.</span><span class="token function">CreateBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">SetMarket</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>QotCommon<span class="token punctuation">.</span>QotMarket<span class="token punctuation">.</span>QotMarket_HK_Security<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">SetCode</span><span class="token punctuation">(</span><span class="token string">&quot;00700&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">QotRequestHistoryKL<span class="token punctuation">.</span>C2S</span> c2s <span class="token operator">=</span> QotRequestHistoryKL<span class="token punctuation">.</span>C2S<span class="token punctuation">.</span><span class="token function">CreateBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">SetRehabType</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>QotCommon<span class="token punctuation">.</span>RehabType<span class="token punctuation">.</span>RehabType_Forward<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">SetKlType</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>QotCommon<span class="token punctuation">.</span>KLType<span class="token punctuation">.</span>KLType_1Min<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">SetSecurity</span><span class="token punctuation">(</span>sec<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">SetBeginTime</span><span class="token punctuation">(</span><span class="token string">&quot;2020-09-01&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">SetEndTime</span><span class="token punctuation">(</span><span class="token string">&quot;2020-09-10&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">QotRequestHistoryKL<span class="token punctuation">.</span>Request</span> req <span class="token operator">=</span> QotRequestHistoryKL<span class="token punctuation">.</span>Request<span class="token punctuation">.</span><span class="token function">CreateBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetC2S</span><span class="token punctuation">(</span>c2s<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">uint</span></span> seqNo <span class="token operator">=</span> qot<span class="token punctuation">.</span><span class="token function">RequestHistoryKL</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">&quot;Send QotRequestHistoryKL: {0}\n&quot;</span><span class="token punctuation">,</span> seqNo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnDisconnect</span><span class="token punctuation">(</span><span class="token class-name">MMAPI_Conn</span> client<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">long</span></span> errCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">&quot;Qot onDisConnect: {0}\n&quot;</span><span class="token punctuation">,</span> errCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnReply_RequestHistoryKL</span><span class="token punctuation">(</span><span class="token class-name">MMAPI_Conn</span> client<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">uint</span></span> nSerialNo<span class="token punctuation">,</span> <span class="token class-name">QotRequestHistoryKL<span class="token punctuation">.</span>Response</span> rsp<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">&quot;Reply: QotRequestHistoryKL: {0}  {1}\n&quot;</span><span class="token punctuation">,</span> nSerialNo<span class="token punctuation">,</span> rsp<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">&quot;Code: {0},  lastClosePrice: {1} \n&quot;</span><span class="token punctuation">,</span>
            rsp<span class="token punctuation">.</span>S2C<span class="token punctuation">.</span>Security<span class="token punctuation">.</span>Code<span class="token punctuation">,</span>
            rsp<span class="token punctuation">.</span>S2C<span class="token punctuation">.</span>KlListList<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>LastClosePrice<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name">String<span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        MMAPI<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Program</span> qot <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Program</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        qot<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
            Thread<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br></div></div><ul><li><strong>Output</strong></li></ul> <div class="language-cs line-numbers-mode"><pre class="language-cs"><code><span class="token class-name">Qot</span> onInitConnect<span class="token punctuation">:</span> ret<span class="token operator">=</span><span class="token number">0</span> desc<span class="token operator">=</span> connID<span class="token operator">=</span><span class="token number">6819076272648767075</span>
<span class="token class-name">Send</span> QotRequestHistoryKL<span class="token punctuation">:</span> <span class="token number">3</span>
Reply<span class="token punctuation">:</span> QotRequestHistoryKL<span class="token punctuation">:</span> <span class="token number">3</span>  retType<span class="token punctuation">:</span> <span class="token number">0</span>
retMsg<span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span>
errCode<span class="token punctuation">:</span> <span class="token number">0</span>
s2c <span class="token punctuation">{</span>
  security <span class="token punctuation">{</span>
    market<span class="token punctuation">:</span> <span class="token number">1</span>
    code<span class="token punctuation">:</span> <span class="token string">&quot;00700&quot;</span>
  <span class="token punctuation">}</span>
  klList <span class="token punctuation">{</span>
    time<span class="token punctuation">:</span> <span class="token string">&quot;2020-09-01 09:30:00&quot;</span>
    isBlank<span class="token punctuation">:</span> <span class="token class-name">false</span>
    highPrice<span class="token punctuation">:</span> <span class="token number">535.9</span>
    openPrice<span class="token punctuation">:</span> <span class="token number">535.9</span>
    lowPrice<span class="token punctuation">:</span> <span class="token number">535.9</span>
    closePrice<span class="token punctuation">:</span> <span class="token number">535.9</span>
    lastClosePrice<span class="token punctuation">:</span> <span class="token number">528.9</span>
    volume<span class="token punctuation">:</span> <span class="token number">665000</span>
    turnover<span class="token punctuation">:</span> <span class="token number">357437500</span>
    turnoverRate<span class="token punctuation">:</span> <span class="token number">0</span>
    pe<span class="token punctuation">:</span> <span class="token number">0</span>
    changeRate<span class="token punctuation">:</span> <span class="token number">1.3235016071090944</span>
    timestamp<span class="token punctuation">:</span> <span class="token number">1598923800</span>
  <span class="token punctuation">}</span>
  <span class="token range operator">..</span><span class="token punctuation">.</span>
  klList <span class="token punctuation">{</span>
    time<span class="token punctuation">:</span> <span class="token string">&quot;2020-09-09 16:00:00&quot;</span>
    isBlank<span class="token punctuation">:</span> <span class="token class-name">false</span>
    highPrice<span class="token punctuation">:</span> <span class="token number">503.9</span>
    openPrice<span class="token punctuation">:</span> <span class="token number">502.4</span>
    lowPrice<span class="token punctuation">:</span> <span class="token number">501.9</span>
    closePrice<span class="token punctuation">:</span> <span class="token number">502.4</span>
    lastClosePrice<span class="token punctuation">:</span> <span class="token number">502.9</span>
    volume<span class="token punctuation">:</span> <span class="token number">1504800</span>
    turnover<span class="token punctuation">:</span> <span class="token number">758472600</span>
    turnoverRate<span class="token punctuation">:</span> <span class="token number">0</span>
    pe<span class="token punctuation">:</span> <span class="token number">0</span>
    changeRate<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">0.0994233446013124</span>
    timestamp<span class="token punctuation">:</span> <span class="token number">1599638400</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

Code<span class="token punctuation">:</span> <span class="token number">00700</span><span class="token punctuation">,</span>  <span class="token named-parameter punctuation">lastClosePrice</span><span class="token punctuation">:</span> <span class="token number">528.9</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div></div><div class="tab-content" style="display:none;"><p><code>int requestHistoryKL(QotRequestHistoryKL.Request req);</code><br> <code>void onReply_RequestHistoryKL(MMAPI_Conn client, int nSerialNo, QotRequestHistoryKL.Response rsp);</code></p> <ul><li><p><strong>Description</strong></p> <p>Get historical candlesticks</p></li> <li><p><strong>Parameters</strong></p></li></ul> <div class="language-protobuf line-numbers-mode"><pre class="language-protobuf"><code>
<span class="token keyword">message</span> <span class="token class-name">C2S</span>
<span class="token punctuation">{</span>
    <span class="token keyword">required</span> <span class="token builtin">int32</span> rehabType <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//Qot_Common.RehabType, rehabilitation type</span>
    <span class="token keyword">required</span> <span class="token builtin">int32</span> klType <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">//Qot_Common.KLType, timeframe of candlestick</span>
    <span class="token keyword">required</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>Security</span> security <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">//Security code</span>
    <span class="token keyword">required</span> <span class="token builtin">string</span> beginTime <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">//Start time string (Format: yyyy-MM-dd)</span>
    <span class="token keyword">required</span> <span class="token builtin">string</span> endTime <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">//End time string (Format: yyyy-MM-dd)</span>
    <span class="token keyword">optional</span> <span class="token builtin">int32</span> maxAckKLNum <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span> <span class="token comment">//How many candlesticks can be returned at most, if not specified, it means no limit</span>
    <span class="token keyword">optional</span> <span class="token builtin">int64</span> needKLFieldsFlag <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span> <span class="token comment">//Specific fields of candlestick structure to return. A combination of KLFields enumeratio. If not specified, return all fields</span>
    <span class="token keyword">optional</span> <span class="token builtin">bytes</span> nextReqKey <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token comment">//Paging request key</span>
    <span class="token keyword">optional</span> <span class="token builtin">bool</span> extendedTime <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span> <span class="token comment">//Whether to get the pre-market and after-hours currently only supports timeframes of 60-minutes and below.</span>
    <span class="token keyword">optional</span> <span class="token builtin">int32</span> session <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">//Get non-regular data of US stocks, currently only supports timeframes of 60-minutes and below.</span>
<span class="token punctuation">}</span>

<span class="token keyword">message</span> <span class="token class-name">Request</span>
<span class="token punctuation">{</span>
	<span class="token keyword">required</span> <span class="token positional-class-name class-name">C2S</span> c2s <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><blockquote><ul><li>For stock structure refer to <a href="/moomoo-api-doc/en/quote/quote.html#5792">Security</a></li> <li>For stock adjustment type, refer to <a href="/moomoo-api-doc/en/quote/quote.html#7071">RehabType</a></li> <li>For candlestick type, refer to <a href="/moomoo-api-doc/en/quote/quote.html#66">KLType</a></li> <li>For candlestick structure, refer to <a href="/moomoo-api-doc/en/quote/quote.html#5803">KLFields</a></li></ul></blockquote> <ul><li><strong>Return</strong></li></ul> <div class="language-protobuf line-numbers-mode"><pre class="language-protobuf"><code>
<span class="token keyword">message</span> <span class="token class-name">S2C</span>
<span class="token punctuation">{</span>
    <span class="token keyword">required</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>Security</span> security <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//Security</span>
    <span class="token keyword">optional</span> <span class="token builtin">string</span> name <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">// Stock name</span>
    <span class="token keyword">repeated</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>KLine</span> klList <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">//Candlestick data</span>
    <span class="token keyword">optional</span> <span class="token builtin">bytes</span> nextReqKey <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">//Paging request key.</span>
<span class="token punctuation">}</span>

<span class="token keyword">message</span> <span class="token class-name">Response</span>
<span class="token punctuation">{</span>
	<span class="token keyword">required</span> <span class="token builtin">int32</span> retType <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">[</span><span class="token annotation">default</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">400</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//RetType, returned value</span>
	<span class="token keyword">optional</span> <span class="token builtin">string</span> retMsg <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">optional</span> <span class="token builtin">int32</span> errCode <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
	
	<span class="token keyword">optional</span> <span class="token positional-class-name class-name">S2C</span> s2c <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><blockquote><ul><li>For stock structure refer to <a href="/moomoo-api-doc/en/quote/quote.html#5792">Security</a></li> <li>For candlestick structure, refer to <a href="/moomoo-api-doc/en/quote/quote.html#500">KLine</a></li> <li>For interface result, refer to <a href="/moomoo-api-doc/en/ftapi/common.html#8800">RetType</a></li></ul></blockquote> <ul><li><strong>Example</strong></li></ul> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QotDemo</span> <span class="token keyword">implements</span> <span class="token class-name">MMSPI_Qot</span><span class="token punctuation">,</span> <span class="token class-name">MMSPI_Conn</span> <span class="token punctuation">{</span>
    <span class="token class-name">MMAPI_Conn_Qot</span> qot <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MMAPI_Conn_Qot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">QotDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        qot<span class="token punctuation">.</span><span class="token function">setClientInfo</span><span class="token punctuation">(</span><span class="token string">&quot;javaclient&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Set client information</span>
        qot<span class="token punctuation">.</span><span class="token function">setConnSpi</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Set connection callback</span>
        qot<span class="token punctuation">.</span><span class="token function">setQotSpi</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Set transaction callback</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        qot<span class="token punctuation">.</span><span class="token function">initConnect</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">short</span><span class="token punctuation">)</span><span class="token number">11111</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onInitConnect</span><span class="token punctuation">(</span><span class="token class-name">MMAPI_Conn</span> client<span class="token punctuation">,</span> <span class="token keyword">long</span> errCode<span class="token punctuation">,</span> <span class="token class-name">String</span> desc<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Qot onInitConnect: ret=%b desc=%s connID=%d\n&quot;</span><span class="token punctuation">,</span> errCode<span class="token punctuation">,</span> desc<span class="token punctuation">,</span> client<span class="token punctuation">.</span><span class="token function">getConnectID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>errCode <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>

        <span class="token class-name">QotCommon<span class="token punctuation">.</span>Security</span> sec <span class="token operator">=</span> <span class="token class-name">QotCommon<span class="token punctuation">.</span>Security</span><span class="token punctuation">.</span><span class="token function">newBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setMarket</span><span class="token punctuation">(</span><span class="token class-name">QotCommon<span class="token punctuation">.</span>QotMarket<span class="token punctuation">.</span>QotMarket_HK_Security_VALUE</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setCode</span><span class="token punctuation">(</span><span class="token string">&quot;00700&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">QotRequestHistoryKL</span><span class="token punctuation">.</span><span class="token constant">C2S</span> c2s <span class="token operator">=</span> <span class="token class-name">QotRequestHistoryKL</span><span class="token punctuation">.</span><span class="token constant">C2S</span><span class="token punctuation">.</span><span class="token function">newBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setRehabType</span><span class="token punctuation">(</span><span class="token class-name">QotCommon<span class="token punctuation">.</span>RehabType<span class="token punctuation">.</span>RehabType_Forward_VALUE</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setKlType</span><span class="token punctuation">(</span><span class="token class-name">QotCommon<span class="token punctuation">.</span>KLType<span class="token punctuation">.</span>KLType_1Min_VALUE</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setSecurity</span><span class="token punctuation">(</span>sec<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setBeginTime</span><span class="token punctuation">(</span><span class="token string">&quot;2020-09-01&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setEndTime</span><span class="token punctuation">(</span><span class="token string">&quot;2020-09-02&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">QotRequestHistoryKL<span class="token punctuation">.</span>Request</span> req <span class="token operator">=</span> <span class="token class-name">QotRequestHistoryKL<span class="token punctuation">.</span>Request</span><span class="token punctuation">.</span><span class="token function">newBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setC2S</span><span class="token punctuation">(</span>c2s<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> seqNo <span class="token operator">=</span> qot<span class="token punctuation">.</span><span class="token function">requestHistoryKL</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Send QotRequestHistoryKL: %d\n&quot;</span><span class="token punctuation">,</span> seqNo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onDisconnect</span><span class="token punctuation">(</span><span class="token class-name">MMAPI_Conn</span> client<span class="token punctuation">,</span> <span class="token keyword">long</span> errCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Qot onDisConnect: %d\n&quot;</span><span class="token punctuation">,</span> errCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onReply_RequestHistoryKL</span><span class="token punctuation">(</span><span class="token class-name">MMAPI_Conn</span> client<span class="token punctuation">,</span> <span class="token keyword">int</span> nSerialNo<span class="token punctuation">,</span> <span class="token class-name">QotRequestHistoryKL<span class="token punctuation">.</span>Response</span> rsp<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>rsp<span class="token punctuation">.</span><span class="token function">getRetType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;QotRequestHistoryKL failed: %s\n&quot;</span><span class="token punctuation">,</span> rsp<span class="token punctuation">.</span><span class="token function">getRetMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token class-name">String</span> json <span class="token operator">=</span> <span class="token class-name">JsonFormat</span><span class="token punctuation">.</span><span class="token function">printer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>rsp<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Receive QotRequestHistoryKL: %s\n&quot;</span><span class="token punctuation">,</span> json<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InvalidProtocolBufferException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token constant">MMAPI</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">QotDemo</span> qot <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QotDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        qot<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> exc<span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br></div></div><ul><li><strong>Output</strong></li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>Send QotRequestHistoryKL: 2
Receive QotRequestHistoryKL: {
  &quot;retType&quot;: 0,
  &quot;retMsg&quot;: &quot;&quot;,
  &quot;errCode&quot;: 0,
  &quot;s2c&quot;: {
    &quot;security&quot;: {
      &quot;market&quot;: 1,
      &quot;code&quot;: &quot;00700&quot;
    },
    &quot;klList&quot;: [{
      &quot;time&quot;: &quot;2020-09-01 09:30:00&quot;,
      &quot;isBlank&quot;: false,
      &quot;highPrice&quot;: 535.9,
      &quot;openPrice&quot;: 535.9,
      &quot;lowPrice&quot;: 535.9,
      &quot;closePrice&quot;: 535.9,
      &quot;lastClosePrice&quot;: 528.9,
      &quot;volume&quot;: &quot;665000&quot;,
      &quot;turnover&quot;: 3.574375E8,
      &quot;turnoverRate&quot;: 0.0,
      &quot;pe&quot;: 0.0,
      &quot;changeRate&quot;: 1.3235016071090944,
      &quot;timestamp&quot;: 1.5989238E9
    }, ... {
      &quot;time&quot;: &quot;2020-09-01 16:00:00&quot;,
      &quot;isBlank&quot;: false,
      &quot;highPrice&quot;: 542.4,
      &quot;openPrice&quot;: 542.4,
      &quot;lowPrice&quot;: 537.4,
      &quot;closePrice&quot;: 537.4,
      &quot;lastClosePrice&quot;: 542.4,
      &quot;volume&quot;: &quot;1303900&quot;,
      &quot;turnover&quot;: 7.0309225E8,
      &quot;turnoverRate&quot;: 0.0,
      &quot;pe&quot;: 0.0,
      &quot;changeRate&quot;: -0.9218289085545722,
      &quot;timestamp&quot;: 1.5989472E9
    }]
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div></div><div class="tab-content" style="display:none;"><p><code>moomoo::u32_t RequestHistoryKL(const Qot_RequestHistoryKL::Request &amp;stReq);</code><br> <code>virtual void OnReply_RequestHistoryKL(moomoo::u32_t nSerialNo, const Qot_RequestHistoryKL::Response &amp;stRsp) = 0;</code></p> <ul><li><p><strong>Description</strong></p> <p>Get historical candlesticks</p></li> <li><p><strong>Parameters</strong></p></li></ul> <div class="language-protobuf line-numbers-mode"><pre class="language-protobuf"><code>
<span class="token keyword">message</span> <span class="token class-name">C2S</span>
<span class="token punctuation">{</span>
    <span class="token keyword">required</span> <span class="token builtin">int32</span> rehabType <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//Qot_Common.RehabType, rehabilitation type</span>
    <span class="token keyword">required</span> <span class="token builtin">int32</span> klType <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">//Qot_Common.KLType, timeframe of candlestick</span>
    <span class="token keyword">required</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>Security</span> security <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">//Security code</span>
    <span class="token keyword">required</span> <span class="token builtin">string</span> beginTime <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">//Start time string (Format: yyyy-MM-dd)</span>
    <span class="token keyword">required</span> <span class="token builtin">string</span> endTime <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">//End time string (Format: yyyy-MM-dd)</span>
    <span class="token keyword">optional</span> <span class="token builtin">int32</span> maxAckKLNum <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span> <span class="token comment">//How many candlesticks can be returned at most, if not specified, it means no limit</span>
    <span class="token keyword">optional</span> <span class="token builtin">int64</span> needKLFieldsFlag <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span> <span class="token comment">//Specific fields of candlestick structure to return. A combination of KLFields enumeratio. If not specified, return all fields</span>
    <span class="token keyword">optional</span> <span class="token builtin">bytes</span> nextReqKey <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token comment">//Paging request key</span>
    <span class="token keyword">optional</span> <span class="token builtin">bool</span> extendedTime <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span> <span class="token comment">//Whether to get the pre-market and after-hours currently only supports timeframes of 60-minutes and below.</span>
    <span class="token keyword">optional</span> <span class="token builtin">int32</span> session <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">//Get non-regular data of US stocks, currently only supports timeframes of 60-minutes and below.</span>
<span class="token punctuation">}</span>

<span class="token keyword">message</span> <span class="token class-name">Request</span>
<span class="token punctuation">{</span>
	<span class="token keyword">required</span> <span class="token positional-class-name class-name">C2S</span> c2s <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><blockquote><ul><li>For stock structure refer to <a href="/moomoo-api-doc/en/quote/quote.html#5792">Security</a></li> <li>For stock adjustment type, refer to <a href="/moomoo-api-doc/en/quote/quote.html#7071">RehabType</a></li> <li>For candlestick type, refer to <a href="/moomoo-api-doc/en/quote/quote.html#66">KLType</a></li> <li>For candlestick structure, refer to <a href="/moomoo-api-doc/en/quote/quote.html#5803">KLFields</a></li></ul></blockquote> <ul><li><strong>Return</strong></li></ul> <div class="language-protobuf line-numbers-mode"><pre class="language-protobuf"><code>
<span class="token keyword">message</span> <span class="token class-name">S2C</span>
<span class="token punctuation">{</span>
    <span class="token keyword">required</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>Security</span> security <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//Security</span>
    <span class="token keyword">optional</span> <span class="token builtin">string</span> name <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">// Stock name</span>
    <span class="token keyword">repeated</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>KLine</span> klList <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">//Candlestick data</span>
    <span class="token keyword">optional</span> <span class="token builtin">bytes</span> nextReqKey <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">//Paging request key.</span>
<span class="token punctuation">}</span>

<span class="token keyword">message</span> <span class="token class-name">Response</span>
<span class="token punctuation">{</span>
	<span class="token keyword">required</span> <span class="token builtin">int32</span> retType <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">[</span><span class="token annotation">default</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">400</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//RetType, returned value</span>
	<span class="token keyword">optional</span> <span class="token builtin">string</span> retMsg <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">optional</span> <span class="token builtin">int32</span> errCode <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
	
	<span class="token keyword">optional</span> <span class="token positional-class-name class-name">S2C</span> s2c <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><blockquote><ul><li>For stock structure refer to <a href="/moomoo-api-doc/en/quote/quote.html#5792">Security</a></li> <li>For candlestick structure, refer to <a href="/moomoo-api-doc/en/quote/quote.html#500">KLine</a></li> <li>For interface result, refer to <a href="/moomoo-api-doc/en/ftapi/common.html#8800">RetType</a></li></ul></blockquote> <ul><li><strong>Example</strong></li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Program</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">MMSPI_Qot</span><span class="token punctuation">,</span> <span class="token keyword">public</span> <span class="token class-name">MMSPI_Trd</span><span class="token punctuation">,</span> <span class="token keyword">public</span> <span class="token class-name">MMSPI_Conn</span></span>
<span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>

	<span class="token function">Program</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		m_pQotApi <span class="token operator">=</span> <span class="token class-name">MMAPI</span><span class="token double-colon punctuation">::</span><span class="token function">CreateQotApi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		m_pQotApi<span class="token operator">-&gt;</span><span class="token function">RegisterQotSpi</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		m_pQotApi<span class="token operator">-&gt;</span><span class="token function">RegisterConnSpi</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token operator">~</span><span class="token function">Program</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>m_pQotApi <span class="token operator">!=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			m_pQotApi<span class="token operator">-&gt;</span><span class="token function">UnregisterQotSpi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			m_pQotApi<span class="token operator">-&gt;</span><span class="token function">UnregisterConnSpi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">MMAPI</span><span class="token double-colon punctuation">::</span><span class="token function">ReleaseQotApi</span><span class="token punctuation">(</span>m_pQotApi<span class="token punctuation">)</span><span class="token punctuation">;</span>
			m_pQotApi <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">void</span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		m_pQotApi<span class="token operator">-&gt;</span><span class="token function">InitConnect</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span> <span class="token number">11111</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>


	<span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">OnInitConnect</span><span class="token punctuation">(</span>MMAPI_Conn<span class="token operator">*</span> pConn<span class="token punctuation">,</span> moomoo<span class="token double-colon punctuation">::</span>i64_t nErrCode<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> strDesc<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;connect&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

		<span class="token comment">// construct request message</span>
		Qot_RequestHistoryKL<span class="token double-colon punctuation">::</span>Request req<span class="token punctuation">;</span>
		Qot_RequestHistoryKL<span class="token double-colon punctuation">::</span>C2S <span class="token operator">*</span>c2s <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">mutable_c2s</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		c2s<span class="token operator">-&gt;</span><span class="token function">set_rehabtype</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		c2s<span class="token operator">-&gt;</span><span class="token function">set_kltype</span><span class="token punctuation">(</span>Qot_Common<span class="token double-colon punctuation">::</span>KLType<span class="token double-colon punctuation">::</span>KLType_1Min<span class="token punctuation">)</span><span class="token punctuation">;</span>
		Qot_Common<span class="token double-colon punctuation">::</span>Security <span class="token operator">*</span>sec <span class="token operator">=</span> c2s<span class="token operator">-&gt;</span><span class="token function">mutable_security</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		sec<span class="token operator">-&gt;</span><span class="token function">set_code</span><span class="token punctuation">(</span><span class="token string">&quot;00700&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		sec<span class="token operator">-&gt;</span><span class="token function">set_market</span><span class="token punctuation">(</span>Qot_Common<span class="token double-colon punctuation">::</span>QotMarket<span class="token double-colon punctuation">::</span>QotMarket_HK_Security<span class="token punctuation">)</span><span class="token punctuation">;</span>
		c2s<span class="token operator">-&gt;</span><span class="token function">set_begintime</span><span class="token punctuation">(</span><span class="token string">&quot;2021-06-07&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		c2s<span class="token operator">-&gt;</span><span class="token function">set_endtime</span><span class="token punctuation">(</span><span class="token string">&quot;2021-07-01&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        m_RequestHistoryKLSerialNo <span class="token operator">=</span> m_pQotApi<span class="token operator">-&gt;</span><span class="token function">RequestHistoryKL</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Request RequestHistoryKL SerialNo: &quot;</span> <span class="token operator">&lt;&lt;</span> m_RequestHistoryKLSerialNo <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">OnReply_RequestHistoryKL</span><span class="token punctuation">(</span>moomoo<span class="token double-colon punctuation">::</span>u32_t nSerialNo<span class="token punctuation">,</span> <span class="token keyword">const</span> Qot_RequestHistoryKL<span class="token double-colon punctuation">::</span>Response <span class="token operator">&amp;</span>stRsp<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>nSerialNo <span class="token operator">==</span> m_RequestHistoryKLSerialNo<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;OnReply_RequestHistoryKL SerialNo: &quot;</span> <span class="token operator">&lt;&lt;</span> nSerialNo <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> 
			<span class="token comment">// print response</span>
			<span class="token comment">// ProtoBufToBodyData and UTF8ToLocal refer to tool.h in Samples</span>
            string resp_str<span class="token punctuation">;</span>
            <span class="token function">ProtoBufToBodyData</span><span class="token punctuation">(</span>stRsp<span class="token punctuation">,</span> resp_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token function">UTF8ToLocal</span><span class="token punctuation">(</span>resp_str<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

<span class="token keyword">protected</span><span class="token operator">:</span>
	MMAPI_Qot <span class="token operator">*</span>m_pQotApi<span class="token punctuation">;</span>
    
    moomoo<span class="token double-colon punctuation">::</span>u32_t m_RequestHistoryKLSerialNo<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int32_t</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int32_t</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">*</span> argv<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token class-name">MMAPI</span><span class="token double-colon punctuation">::</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token punctuation">{</span>
		Program program<span class="token punctuation">;</span>
		program<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	protobuf<span class="token double-colon punctuation">::</span><span class="token function">ShutdownProtobufLibrary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">MMAPI</span><span class="token double-colon punctuation">::</span><span class="token function">UnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br></div></div><ul><li><strong>Output</strong></li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>connect
Request RequestHistoryKL SerialNo: 3
OnReply_RequestHistoryKL SerialNo: 3
{
 &quot;retType&quot;: 0,
 &quot;retMsg&quot;: &quot;&quot;,
 &quot;errCode&quot;: 0,
 &quot;s2c&quot;: {
  &quot;security&quot;: {
   &quot;market&quot;: 1,
   &quot;code&quot;: &quot;00700&quot;
  },
  &quot;klList&quot;: [
   {
    &quot;time&quot;: &quot;2021-06-07 09:30:00&quot;,
    &quot;isBlank&quot;: false,
    &quot;highPrice&quot;: 611,
    &quot;openPrice&quot;: 611,
    &quot;lowPrice&quot;: 611,
    &quot;closePrice&quot;: 611,
    &quot;lastClosePrice&quot;: 611.5,
    &quot;volume&quot;: &quot;250100&quot;,
    &quot;turnover&quot;: 152811100,
    &quot;turnoverRate&quot;: 0,
    &quot;pe&quot;: 0,
    &quot;changeRate&quot;: -0.081766148814390843,
    &quot;timestamp&quot;: 1623029400
   },
   {
    &quot;time&quot;: &quot;2021-06-07 09:31:00&quot;,
    &quot;isBlank&quot;: false,
    &quot;highPrice&quot;: 611.5,
    &quot;openPrice&quot;: 611,
    &quot;lowPrice&quot;: 609,
    &quot;closePrice&quot;: 609.5,
    &quot;lastClosePrice&quot;: 611,
    &quot;volume&quot;: &quot;230700&quot;,
    &quot;turnover&quot;: 140792100,
    &quot;turnoverRate&quot;: 0,
    &quot;pe&quot;: 0,
    &quot;changeRate&quot;: -0.24549918166939444,
    &quot;timestamp&quot;: 1623029460
   },
...
   {
    &quot;time&quot;: &quot;2021-06-09 14:14:00&quot;,
    &quot;isBlank&quot;: false,
    &quot;highPrice&quot;: 601,
    &quot;openPrice&quot;: 600.5,
    &quot;lowPrice&quot;: 600,
    &quot;closePrice&quot;: 601,
    &quot;lastClosePrice&quot;: 600,
    &quot;volume&quot;: &quot;19300&quot;,
    &quot;turnover&quot;: 11589150,
    &quot;turnoverRate&quot;: 0,
    &quot;pe&quot;: 0,
    &quot;changeRate&quot;: 0.16666666666666669,
    &quot;timestamp&quot;: 1623219240
   }
  ]
 }
}

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br></div></div></div><div class="tab-content" style="display:none;"><p><code>RequestHistoryKL(req);</code></p> <ul><li><p><strong>Description</strong></p> <p>Get historical candlesticks</p></li> <li><p><strong>Parameters</strong></p></li></ul> <div class="language-protobuf line-numbers-mode"><pre class="language-protobuf"><code>
<span class="token keyword">message</span> <span class="token class-name">C2S</span>
<span class="token punctuation">{</span>
    <span class="token keyword">required</span> <span class="token builtin">int32</span> rehabType <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//Qot_Common.RehabType, rehabilitation type</span>
    <span class="token keyword">required</span> <span class="token builtin">int32</span> klType <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">//Qot_Common.KLType, timeframe of candlestick</span>
    <span class="token keyword">required</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>Security</span> security <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">//Security code</span>
    <span class="token keyword">required</span> <span class="token builtin">string</span> beginTime <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">//Start time string (Format: yyyy-MM-dd)</span>
    <span class="token keyword">required</span> <span class="token builtin">string</span> endTime <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">//End time string (Format: yyyy-MM-dd)</span>
    <span class="token keyword">optional</span> <span class="token builtin">int32</span> maxAckKLNum <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span> <span class="token comment">//How many candlesticks can be returned at most, if not specified, it means no limit</span>
    <span class="token keyword">optional</span> <span class="token builtin">int64</span> needKLFieldsFlag <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span> <span class="token comment">//Specific fields of candlestick structure to return. A combination of KLFields enumeratio. If not specified, return all fields</span>
    <span class="token keyword">optional</span> <span class="token builtin">bytes</span> nextReqKey <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token comment">//Paging request key</span>
    <span class="token keyword">optional</span> <span class="token builtin">bool</span> extendedTime <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span> <span class="token comment">//Whether to get the pre-market and after-hours currently only supports timeframes of 60-minutes and below.</span>
    <span class="token keyword">optional</span> <span class="token builtin">int32</span> session <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">//Get non-regular data of US stocks, currently only supports timeframes of 60-minutes and below.</span>
<span class="token punctuation">}</span>

<span class="token keyword">message</span> <span class="token class-name">Request</span>
<span class="token punctuation">{</span>
	<span class="token keyword">required</span> <span class="token positional-class-name class-name">C2S</span> c2s <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><blockquote><ul><li>For stock structure refer to <a href="/moomoo-api-doc/en/quote/quote.html#5792">Security</a></li> <li>For stock adjustment type, refer to <a href="/moomoo-api-doc/en/quote/quote.html#7071">RehabType</a></li> <li>For candlestick type, refer to <a href="/moomoo-api-doc/en/quote/quote.html#66">KLType</a></li> <li>For candlestick structure, refer to <a href="/moomoo-api-doc/en/quote/quote.html#5803">KLFields</a></li></ul></blockquote> <ul><li><strong>Return</strong></li></ul> <div class="language-protobuf line-numbers-mode"><pre class="language-protobuf"><code>
<span class="token keyword">message</span> <span class="token class-name">S2C</span>
<span class="token punctuation">{</span>
    <span class="token keyword">required</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>Security</span> security <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//Security</span>
    <span class="token keyword">optional</span> <span class="token builtin">string</span> name <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">// Stock name</span>
    <span class="token keyword">repeated</span> <span class="token positional-class-name class-name">Qot_Common<span class="token punctuation">.</span>KLine</span> klList <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">//Candlestick data</span>
    <span class="token keyword">optional</span> <span class="token builtin">bytes</span> nextReqKey <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">//Paging request key.</span>
<span class="token punctuation">}</span>

<span class="token keyword">message</span> <span class="token class-name">Response</span>
<span class="token punctuation">{</span>
	<span class="token keyword">required</span> <span class="token builtin">int32</span> retType <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">[</span><span class="token annotation">default</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">400</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//RetType, returned value</span>
	<span class="token keyword">optional</span> <span class="token builtin">string</span> retMsg <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">optional</span> <span class="token builtin">int32</span> errCode <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
	
	<span class="token keyword">optional</span> <span class="token positional-class-name class-name">S2C</span> s2c <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><blockquote><ul><li>For stock structure refer to <a href="/moomoo-api-doc/en/quote/quote.html#5792">Security</a></li> <li>For candlestick structure, refer to <a href="/moomoo-api-doc/en/quote/quote.html#500">KLine</a></li> <li>For interface result, refer to <a href="/moomoo-api-doc/en/ftapi/common.html#8800">RetType</a></li></ul></blockquote> <ul><li><strong>Example</strong></li></ul> <div class="language-JavaScript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> mmWebsocket <span class="token keyword">from</span> <span class="token string">&quot;moomoo-api&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> mmCmdID <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;moomoo-api&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Common<span class="token punctuation">,</span> Qot_Common <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;moomoo-api/proto&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> beautify <span class="token keyword">from</span> <span class="token string">&quot;js-beautify&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">QotRequestHistoryKL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> RetType <span class="token punctuation">}</span> <span class="token operator">=</span> Common
    <span class="token keyword">const</span> <span class="token punctuation">{</span> RehabType<span class="token punctuation">,</span> KLType<span class="token punctuation">,</span> SubType<span class="token punctuation">,</span> QotMarket <span class="token punctuation">}</span> <span class="token operator">=</span> Qot_Common
    <span class="token keyword">let</span> <span class="token punctuation">[</span>addr<span class="token punctuation">,</span> port<span class="token punctuation">,</span> enable_ssl<span class="token punctuation">,</span> key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span> <span class="token number">33333</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">'7522027ccf5a06b1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> websocket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mmWebsocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    websocket<span class="token punctuation">.</span><span class="token function-variable function">onlogin</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">ret<span class="token punctuation">,</span> msg</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>ret<span class="token punctuation">)</span> <span class="token punctuation">{</span> 

            <span class="token keyword">const</span> req <span class="token operator">=</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">c2s</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token literal-property property">rehabType</span><span class="token operator">:</span> RehabType<span class="token punctuation">.</span>RehabType_None<span class="token punctuation">,</span> 
                    <span class="token literal-property property">klType</span><span class="token operator">:</span> KLType<span class="token punctuation">.</span>KLType_Day<span class="token punctuation">,</span>
                    <span class="token literal-property property">security</span><span class="token operator">:</span><span class="token punctuation">{</span>
                        <span class="token literal-property property">market</span><span class="token operator">:</span> QotMarket<span class="token punctuation">.</span>QotMarket_HK_Security<span class="token punctuation">,</span>
                        <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token string">&quot;00700&quot;</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">beginTime</span><span class="token operator">:</span> <span class="token string">&quot;2021-08-05&quot;</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">endTime</span><span class="token operator">:</span> <span class="token string">&quot;2021-08-10&quot;</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            
            websocket<span class="token punctuation">.</span><span class="token function">RequestHistoryKL</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">let</span> <span class="token punctuation">{</span> errCode<span class="token punctuation">,</span> retMsg<span class="token punctuation">,</span> retType<span class="token punctuation">,</span>s2c <span class="token punctuation">}</span> <span class="token operator">=</span> res
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;HistoryKL: errCode %d, retMsg %s, retType %d&quot;</span><span class="token punctuation">,</span> errCode<span class="token punctuation">,</span> retMsg<span class="token punctuation">,</span> retType<span class="token punctuation">)</span><span class="token punctuation">;</span> 
                <span class="token keyword">if</span><span class="token punctuation">(</span>retType <span class="token operator">==</span> RetType<span class="token punctuation">.</span>RetType_Succeed<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token function">beautify</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>s2c<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                        <span class="token literal-property property">indent_size</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">space_in_empty_paren</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;error:&quot;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    websocket<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span>addr<span class="token punctuation">,</span> port<span class="token punctuation">,</span> enable_ssl<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// After using the connection, remember to close it to prevent the number of connections from running out</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span> 
        websocket<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;stop&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Set the script to receive OpenD push duration to 5 seconds</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><ul><li><strong>Output</strong></li></ul> <div class="language-JavaScript line-numbers-mode"><pre class="language-javascript"><code><span class="token literal-property property">OwnerPlate</span><span class="token operator">:</span> errCode <span class="token number">0</span><span class="token punctuation">,</span> retMsg <span class="token punctuation">,</span> retType <span class="token number">0</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;security&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;market&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;00700&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;klList&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    <span class="token string-property property">&quot;time&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-08-05 00:00:00&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;isBlank&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;highPrice&quot;</span><span class="token operator">:</span> <span class="token number">464.4</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;openPrice&quot;</span><span class="token operator">:</span> <span class="token number">452.6</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;lowPrice&quot;</span><span class="token operator">:</span> <span class="token number">432.6</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;closePrice&quot;</span><span class="token operator">:</span> <span class="token number">439</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;lastClosePrice&quot;</span><span class="token operator">:</span> <span class="token number">456.8</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;volume&quot;</span><span class="token operator">:</span> <span class="token string">&quot;58625939&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;turnover&quot;</span><span class="token operator">:</span> <span class="token number">26193545519</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;turnoverRate&quot;</span><span class="token operator">:</span> <span class="token number">0.00611</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;pe&quot;</span><span class="token operator">:</span> <span class="token number">22.137</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;changeRate&quot;</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">3.896672504378286</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token number">1628092800</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;time&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-08-06 00:00:00&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;isBlank&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;highPrice&quot;</span><span class="token operator">:</span> <span class="token number">460.4</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;openPrice&quot;</span><span class="token operator">:</span> <span class="token number">444.8</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;lowPrice&quot;</span><span class="token operator">:</span> <span class="token number">440</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;closePrice&quot;</span><span class="token operator">:</span> <span class="token number">453.6</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;lastClosePrice&quot;</span><span class="token operator">:</span> <span class="token number">439</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;volume&quot;</span><span class="token operator">:</span> <span class="token string">&quot;42946505&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;turnover&quot;</span><span class="token operator">:</span> <span class="token number">19468783995</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;turnoverRate&quot;</span><span class="token operator">:</span> <span class="token number">0.00447</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;pe&quot;</span><span class="token operator">:</span> <span class="token number">22.873</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;changeRate&quot;</span><span class="token operator">:</span> <span class="token number">3.3257403189066106</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token number">1628179200</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;time&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-08-09 00:00:00&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;isBlank&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;highPrice&quot;</span><span class="token operator">:</span> <span class="token number">472.4</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;openPrice&quot;</span><span class="token operator">:</span> <span class="token number">447.8</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;lowPrice&quot;</span><span class="token operator">:</span> <span class="token number">442.6</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;closePrice&quot;</span><span class="token operator">:</span> <span class="token number">461.6</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;lastClosePrice&quot;</span><span class="token operator">:</span> <span class="token number">453.6</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;volume&quot;</span><span class="token operator">:</span> <span class="token string">&quot;40956433&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;turnover&quot;</span><span class="token operator">:</span> <span class="token number">18847164570</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;turnoverRate&quot;</span><span class="token operator">:</span> <span class="token number">0.00427</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;pe&quot;</span><span class="token operator">:</span> <span class="token number">23.276</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;changeRate&quot;</span><span class="token operator">:</span> <span class="token number">1.763668430335097</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token number">1628438400</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;time&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-08-10 00:00:00&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;isBlank&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;highPrice&quot;</span><span class="token operator">:</span> <span class="token number">493</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;openPrice&quot;</span><span class="token operator">:</span> <span class="token number">478</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;lowPrice&quot;</span><span class="token operator">:</span> <span class="token number">473.2</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;closePrice&quot;</span><span class="token operator">:</span> <span class="token number">486.2</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;lastClosePrice&quot;</span><span class="token operator">:</span> <span class="token number">461.6</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;volume&quot;</span><span class="token operator">:</span> <span class="token string">&quot;40881986&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;turnover&quot;</span><span class="token operator">:</span> <span class="token number">19749306230</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;turnoverRate&quot;</span><span class="token operator">:</span> <span class="token number">0.00426</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;pe&quot;</span><span class="token operator">:</span> <span class="token number">24.517</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;changeRate&quot;</span><span class="token operator">:</span> <span class="token number">5.329289428076249</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token number">1628524800</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
stop
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br></div></div></div></div> <div class="custom-block tip"><p class="custom-block-title">Interface Restrictions</p> <ul><li>Candlestick data with timeframes of <strong>60 minutes and below</strong>, is only supported for the last 8 years. <strong>Daily</strong> candlestick data is supported for the last 20 years. <strong>Daily above</strong> candlestick data is not restricted.</li> <li>We will issue historical candlestick quota based on your account assets and transaction conditions. Therefore, you can only obtain historical candlestick data for a limited number of stocks within 30 days. For specific rules, please refer to <a href="/moomoo-api-doc/en/intro/authority.html#9123">Subscription Quota &amp; Historical Candlestick Quota</a>. The historical candlestick quota you consume on that day will be automatically released after 30 days.</li> <li>A maximum of 60 requests per 30 seconds. Note: If you obtain data by page, this frequency limit rule is only applicable to the first time calling the interface, and subsequent pages request frequency is unlimited.</li> <li><em>Change rate</em>, only supports timeframes of daily and above.</li> <li><strong>Options</strong> related candlestick data, only supports 1 day, 1 minute, 5 minutes, 15 minutes and 60 minutes.</li> <li>The pre-market, after-hours and overnight candlestick of US stocks, only supports timeframes of 60 minutes and below. Since the pre-market, after-hours and overnight session of the US stock market are irregular trading hours, the candlestick data for this period may be less than 2 years.</li> <li><em>Turnover</em> of US stocks, only supports data after 2015-10-12.</li></ul></div></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/moomoo-api-doc/en/quote/get-owner-plate.html" class="prev">
        Get Plates of Stocks
      </a></span> <span class="next"><a href="/moomoo-api-doc/en/quote/get-rehab.html">
        Get Adjustment Factor
      </a>
      →
    </span></p></div> </main> <aside class="rightbar"><ul class="rightbar-links"><a href="/moomoo-api-doc/en/quote/request-history-kline.html" aria-current="page" class="active rightbar-link">Get Historical Candlesticks</a></ul></aside></div><div class="global-ui"></div></div>
    <script src="/moomoo-api-doc/assets/js/app.76d125c0.js" defer></script><script src="/moomoo-api-doc/assets/js/2.e1858e4a.js" defer></script><script src="/moomoo-api-doc/assets/js/75.654e7361.js" defer></script><script src="/moomoo-api-doc/assets/js/28.3fe3716c.js" defer></script><script src="/moomoo-api-doc/assets/js/35.424be492.js" defer></script><script src="/moomoo-api-doc/assets/js/24.9af08641.js" defer></script>
  </body>
</html>
